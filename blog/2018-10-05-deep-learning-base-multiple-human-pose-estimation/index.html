<!DOCTYPE HTML>

<html>

    <head>
	<script src="https://www.googleoptimize.com/optimize.js?id=OPT-52RT2BV"></script>
        <script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "\/"
        },
        "articleSection" : "blog",
        "name" : "Deep Learning based Multiple Human Pose Estimation using OpenCV",
        "headline" : "Deep Learning based Multiple Human Pose Estimation using OpenCV",
        "description" : "Ở bài viết này, chúng ta đề cập đến vấn đề sử dụng Deep Neural Net trong việc thực hiện Human Pose Estimation.",
        "inLanguage" : "en",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2018",
        "datePublished": "2018-10-05 00:19:00 \x2b0300 \x2b0300",
        "dateModified" : "2018-10-05 00:19:00 \x2b0300 \x2b0300",
        "url" : "\/blog\/2018-10-05-deep-learning-base-multiple-human-pose-estimation\/",
        "wordCount" : "1263",
        "keywords" : [ "Machine learning","Deeplearning","multiple pose estimation","Blog" ]
    }
    </script>
        
            
                <title>Deep Learning based Multiple Human Pose Estimation using OpenCV</title>
            
        

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        
		<meta name="generator" content="Phạm Duy Tùng" />
        
  
    
  

  

  
  
  
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content='/favicon/mstile.png'>
  <meta name="application-name" content="Phạm Duy Tùng Machine Learning Blog">
  <meta name="msapplication-tooltip" content="Blog ML của Phạm Duy Tùng và Đặng Thị Hằng">
   
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">



        
        
            <meta name="description" content="Ở bài viết này, chúng ta đề cập đến vấn đề sử dụng Deep Neural Net trong việc thực hiện Human Pose Estimation.">
        

        <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Deep Learning based Multiple Human Pose Estimation using OpenCV"/>
<meta name="twitter:description" content="Ở bài viết này, chúng ta đề cập đến vấn đề sử dụng Deep Neural Net trong việc thực hiện Human Pose Estimation."/>
<meta name="twitter:site" content="@example"/>

        <meta property="og:title" content="Deep Learning based Multiple Human Pose Estimation using OpenCV" />
<meta property="og:description" content="Ở bài viết này, chúng ta đề cập đến vấn đề sử dụng Deep Neural Net trong việc thực hiện Human Pose Estimation." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/2018-10-05-deep-learning-base-multiple-human-pose-estimation/" />
<meta property="article:published_time" content="2018-10-05T00:19:00+03:00" />
<meta property="article:modified_time" content="2018-10-05T00:19:00+03:00" />

        <meta property="og:image" content="//images/logo.png">
        <meta property="og:image:type" content="image/png">
        <meta property="og:image:width" content="512">
        <meta property="og:image:height" content="512">
        <meta itemprop="name" content="Deep Learning based Multiple Human Pose Estimation using OpenCV">
<meta itemprop="description" content="Ở bài viết này, chúng ta đề cập đến vấn đề sử dụng Deep Neural Net trong việc thực hiện Human Pose Estimation.">
<meta itemprop="datePublished" content="2018-10-05T00:19:00&#43;03:00" />
<meta itemprop="dateModified" content="2018-10-05T00:19:00&#43;03:00" />
<meta itemprop="wordCount" content="1263">



<meta itemprop="keywords" content="Machine learning,Deeplearning,multiple pose estimation," />
        

        
            
        

        
        
          
			
			 <link rel="stylesheet" href="/css/font-awesome.min.css">
			 <link rel="stylesheet" href="/css/bootstrap.min.css">


          
            <link rel="stylesheet" href="/css/academicons.min.css">
        

        
            
                
            
        


  
    
    <link href='//cdn.bootcss.com/highlight.js/9.15.8/styles/xcode.min.css' rel='stylesheet' type='text/css' />
  


      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-114911596-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

	    <link rel="stylesheet" href="/css/jquery.amlich.css">
	  <style>
	  
	  body{
font-family: Helvetica,Arial,sans-serif;
}

.card{
	margin-bottom: 10px;
}

#disqus_thread{
padding: 0 5px;
}

.item-header{
padding: 0;
}

.single-content-img{
width: 100%;
    max-height: 450px !important;
    background-size: cover;
    display: block;
    background-position: center;
}

.thumbnail {
    position: relative;
}

.caption {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
	background: rgba(0, 0, 0, 0.25);
	text-align:left;
}

.caption .title{
	font-size: 1.6em;
    line-height: 1.4em;
    top: 0;
	margin-left:20px;
	margin-top:20px;
	
}

.caption .title-caption{
margin-left:10px;
}

#content p{
text-align: justify;
    font-size: 16px;
    color: #333;
    line-height: 28px;
}

#content img{
	display: block;
    margin-left: auto;
margin-right: auto;
max-width:98%;
}

img + strong {
    font-style: normal;
    display: inherit;
    text-align: center;
}
.img-news{
max-height:150px;
width:100%;
}

.news-tittle{
	padding-top:15px;
	text-align:justify;
}

.author{
	color: orange;
}
.author-inline{
	color: orange;
}

.adv{
height:18px;
}


.hljs{
    white-space: pre-wrap;
    white-space: -moz-pre-wrap;
    white-space: -pre-wrap;
    white-space: -o-pre-wrap;
    word-wrap: break-word;}
.titledetail {
    display: block;
    overflow: hidden;
    line-height: 53px;
    font-size: 45px;
    font-family: 'Roboto Condensed',sans-serif;
    font-weight: 600;
    width: 800px;
    margin: auto;
	padding: 0 ;
}

.newsrelate {
    display: block;
    overflow: hidden;
	 list-style:none;
}
a ,a:hover{
    text-decoration: none;
}
.newsrelate li {
    float: left;
    overflow: hidden;
    width: 30%;
    margin-left: 2.5%;
    margin-bottom: 15px;
}

.newsrelate li a {
    display: block;
    overflow: hidden;
}

.userdetail {
    display: block;
    overflow: hidden;
    margin: 0 10px 0 0;
    padding: 15px 0;
}
.newsrelate li h3 {
    display: block;
    overflow: hidden;
    line-height: 1.3em;
    font-size: 16pt;
    line-height: 22px;
    font-weight: 300;
    font-family: Arial,Helvetica,sans-serif;
    width: auto;
    margin: 5px auto;
}

.titlerelate {
    overflow: hidden;
    font-size: 18px;
    font-weight: 600;
    font-family: 'Roboto Condensed',sans-serif;
    line-height: 32px;
    text-transform: uppercase;
}
article .captionnews {
    color: #999;
    font-size: 14px;
    font-style: italic;
    padding: 10px;
    text-align: center;
    margin-bottom: 15px;
}

.bgtrans h1 {
    display: block;
    overflow: hidden;
    font-size: 45px;
    line-height: 55px;
    color: #fff;
    width: 800px;
    margin: auto;
    position: absolute;
    left: 0;
    right: 0;
    bottom: 50px;
    font-family: 'Roboto Condensed',sans-serif;
    font-weight: 600;
}

.bgcover {
    display: block;
    overflow: hidden;
    height: 450px;
    background: no-repeat center center;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
    position: relative;
    margin-bottom: -65px;
}
.bgcover .bgtrans .userdetail {
    width: 800px;
    margin: auto;
    position: absolute;
    left: 0;
    right: 0;
    bottom: 10px;
}
.userdetail {
    display: block;
    overflow: hidden;
    margin: 0 10px 0 0;
    padding: 15px 0;
}
	  </style>

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-P62ZZPB');</script>


<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P62ZZPB"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    </head>
    <body>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '1546237302193677',
      xfbml      : true,
      version    : 'v5.0'
    });
    FB.AppEvents.logPageView();
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "https://connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>
<div id="fb-root"></div>
<script async defer crossorigin="anonymous" src="https://connect.facebook.net/vi_VN/sdk.js#xfbml=1&version=v5.0&appId=1853483258232756&autoLogAppEvents=1"></script>
      
      

    
    
<header id="header"  style="background: #790014; color: hsla(0,0%,100%,1);">
<div class="container">
    <nav class="navbar navbar-expand-md navbar-dark">
	
	<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav mr-auto">
            
                <li class="nav-item">
                    <a class='nav-link' href="/blog">
                            <i class="fa fa-home active">&nbsp;</i>Home
                    </a>
                </li>
            
                <li class="nav-item">
                    <a class='nav-link' href="/news/">
                            <i class="fa fa-list">&nbsp;</i>News
                    </a>
                </li>
            
                <li class="nav-item">
                    <a class='nav-link' href="/xem-truyen/">
                            <i class="fa fa-id-card-o">&nbsp;</i>Truyện
                    </a>
                </li>
            
        </ul>
    </nav>
    </div></div>
</header>


   
    
	<div class="container-fluid">
	<div class="adv"></div>
	
    <main role="main" >
	
        
        
        <article>
  


        
		 <div class="header">
           
			
			
			
		<div class="bgcover" style="background-image:url(../../post_image/post_estimator_shark.gif)" >
		<div class="bgtrans">
		 <h1 class="titledetail">Deep Learning based Multiple Human Pose Estimation using OpenCV</h1>
		<div class="userdetail">
			 
			  <time class="published" style="color: #fff;"
            datetime='2018-10-05'>
            05/10/2018</time>
		 - 
			   <span class="author"></span>
			   
			</div>
		
			</div>
			</div>
			
			<div style="padding-top:80px;"></div>
			</div>
			 
            
        
       



  

  
 
  <div id="content"  class="col-md-8 col-lg-9 mx-auto" style="box-shadow: 0 0 50px 0 rgba(0,0,0,.15);padding:20px;">
    <h2 id="lời-mở-đầu">Lời mở đầu</h2>
<p>Lưu ý: Để sử dụng được các mô hình trong bài viết này, bạn phải sử dụng phiên bản opencv &gt; 3.4.1.</p>
<p>Ở bài viết trước, chúng ta đã tìm hiểu cách thức rút trích khung xương sử dụng DNN và đã áp dụng thành công trên ảnh có chứa 1 đối tượng người. Trong bài viết này, chúng ta sẽ thực hiện áp dụng mô hình cho bài toán có nhiều người trong cùng 1 bức ảnh.</p>
<h2 id="sử-dụng-pretrain-model-trong-bài-toán-multiple-pose-estimation">Sử dụng pretrain model trong bài toán multiple Pose Estimation</h2>
<p>Trong bài viết này, chúng ta tiếp tục sử dụng mô hình MPI để dò tìm các điểm đặc trưng của con người và rút ra mô hình khung xương. Kết quả trả về của thuật toán gồm 15 đặc trưng như bên dưới.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Head <span style="color:#960050;background-color:#1e0010">–</span> <span style="color:#ae81ff">0</span>, Neck <span style="color:#960050;background-color:#1e0010">–</span> <span style="color:#ae81ff">1</span>, Right Shoulder <span style="color:#960050;background-color:#1e0010">–</span> <span style="color:#ae81ff">2</span>, Right Elbow <span style="color:#960050;background-color:#1e0010">–</span> <span style="color:#ae81ff">3</span>, Right Wrist <span style="color:#960050;background-color:#1e0010">–</span> <span style="color:#ae81ff">4</span>,
Left Shoulder <span style="color:#960050;background-color:#1e0010">–</span> <span style="color:#ae81ff">5</span>, Left Elbow <span style="color:#960050;background-color:#1e0010">–</span> <span style="color:#ae81ff">6</span>, Left Wrist <span style="color:#960050;background-color:#1e0010">–</span> <span style="color:#ae81ff">7</span>, Right Hip <span style="color:#960050;background-color:#1e0010">–</span> <span style="color:#ae81ff">8</span>,
Right Knee <span style="color:#960050;background-color:#1e0010">–</span> <span style="color:#ae81ff">9</span>, Right Ankle <span style="color:#960050;background-color:#1e0010">–</span> <span style="color:#ae81ff">10</span>, Left Hip <span style="color:#960050;background-color:#1e0010">–</span> <span style="color:#ae81ff">11</span>, Left Knee <span style="color:#960050;background-color:#1e0010">–</span> <span style="color:#ae81ff">12</span>,
Left Ankle <span style="color:#960050;background-color:#1e0010">–</span> <span style="color:#ae81ff">13</span>, Chest <span style="color:#960050;background-color:#1e0010">–</span> <span style="color:#ae81ff">14</span>, Background <span style="color:#960050;background-color:#1e0010">–</span> <span style="color:#ae81ff">15</span>
</code></pre></div><p>Áp dụng mô hình với ảnh của nhóm T-ARA.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> cv2

nPoints <span style="color:#f92672">=</span> <span style="color:#ae81ff">15</span>
POSE_PAIRS <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>], [<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>], [<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">5</span>], [<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">6</span>], [<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">7</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">14</span>], [<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">8</span>], [<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">9</span>], [<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">10</span>], [<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">11</span>], [<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">12</span>], [<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">13</span>] ]

protoFile <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;pose/mpi/pose_deploy_linevec.prototxt&#34;</span>
weightsFile <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;pose/mpi/pose_iter_160000.caffemodel&#34;</span>

net <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>dnn<span style="color:#f92672">.</span>readNetFromCaffe(protoFile, weightsFile)

frame <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>imread(<span style="color:#e6db74">&#34;tara1.jpg&#34;</span>)

inWidth <span style="color:#f92672">=</span> <span style="color:#ae81ff">368</span>
inHeight <span style="color:#f92672">=</span> <span style="color:#ae81ff">368</span>
 
<span style="color:#75715e"># Prepare the frame to be fed to the network</span>
inpBlob <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>dnn<span style="color:#f92672">.</span>blobFromImage(frame, <span style="color:#ae81ff">1.0</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">255</span>, (inWidth, inHeight), (<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>), swapRB<span style="color:#f92672">=</span>False, crop<span style="color:#f92672">=</span>False)
 
<span style="color:#75715e"># Set the prepared object as the input blob of the network</span>
net<span style="color:#f92672">.</span>setInput(inpBlob)

output <span style="color:#f92672">=</span> net<span style="color:#f92672">.</span>forward()
</code></pre></div><p>Thử show lên vị trí vùng cổ trong hình.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
probMap <span style="color:#f92672">=</span> output[<span style="color:#ae81ff">0</span>, i, :, :]
probMap <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>resize(probMap, (frameWidth, frameHeight))

<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt 

plt<span style="color:#f92672">.</span>imshow(cv2<span style="color:#f92672">.</span>cvtColor(frameCopy, cv2<span style="color:#f92672">.</span>COLOR_BGR2RGB))
plt<span style="color:#f92672">.</span>imshow(probMap, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="/post_image/multiple_pose_estimation_head_heatmap.png" alt="Hình với điểm đặc trưng vùng đầu"></p>
<p>Thử show lên hình điểm đặc trưng vùng cổ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
probMap <span style="color:#f92672">=</span> output[<span style="color:#ae81ff">0</span>, i, :, :]
probMap <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>resize(probMap, (frameWidth, frameHeight))

<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt 

plt<span style="color:#f92672">.</span>imshow(cv2<span style="color:#f92672">.</span>cvtColor(frameCopy, cv2<span style="color:#f92672">.</span>COLOR_BGR2RGB))
plt<span style="color:#f92672">.</span>imshow(probMap, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="/post_image/multiple_pose_estimation_neck_heatmap.png" alt="Hình với điểm đặc trưng vùng cổ"></p>
<p>Bằng một số phép biến đổi quen thuộc có sẵn trong opencv, chúng ta hoàn toàn có thể lấy được toạ độ của các điểm keypoint một cách dễ dàng.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#75715e"># Find the Keypoints using Non Maximum Suppression on the Confidence Map</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getKeypoints</span>(probMap, threshold<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>):
    
    mapSmooth <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>GaussianBlur(probMap,(<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">3</span>),<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>)

    mapMask <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>uint8(mapSmooth<span style="color:#f92672">&gt;</span>threshold)
    keypoints <span style="color:#f92672">=</span> []
    
    <span style="color:#75715e">#find the blobs</span>
    _, contours, _ <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>findContours(mapMask, cv2<span style="color:#f92672">.</span>RETR_TREE, cv2<span style="color:#f92672">.</span>CHAIN_APPROX_SIMPLE)
    
    <span style="color:#75715e">#for each blob find the maxima</span>
    <span style="color:#66d9ef">for</span> cnt <span style="color:#f92672">in</span> contours:
        blobMask <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>zeros(mapMask<span style="color:#f92672">.</span>shape)
        blobMask <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>fillConvexPoly(blobMask, cnt, <span style="color:#ae81ff">1</span>)
        maskedProbMap <span style="color:#f92672">=</span> mapSmooth <span style="color:#f92672">*</span> blobMask
        _, maxVal, _, maxLoc <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>minMaxLoc(maskedProbMap)
        keypoints<span style="color:#f92672">.</span>append(maxLoc <span style="color:#f92672">+</span> (probMap[maxLoc[<span style="color:#ae81ff">1</span>], maxLoc[<span style="color:#ae81ff">0</span>]],))

    <span style="color:#66d9ef">return</span> keypoints


detected_keypoints <span style="color:#f92672">=</span> []
keypoints_list <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>zeros((<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">3</span>))
keypoint_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
threshold <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.1</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(nPoints):
    probMap <span style="color:#f92672">=</span> output[<span style="color:#ae81ff">0</span>, i, :, :]
    probMap <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>resize(probMap, (frameWidth, frameHeight))

    keypoints <span style="color:#f92672">=</span> getKeypoints(probMap, threshold)
    keypoints_with_id <span style="color:#f92672">=</span> []
    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(len(keypoints)):
        keypoints_with_id<span style="color:#f92672">.</span>append(keypoints[j] <span style="color:#f92672">+</span> (keypoint_id,))
        keypoints_list <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>vstack([keypoints_list, keypoints[j]])
        keypoint_id <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>

    detected_keypoints<span style="color:#f92672">.</span>append(keypoints_with_id)



frameClone <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>cvtColor(frameCopy,cv2<span style="color:#f92672">.</span>COLOR_BGR2RGB)
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(nPoints):
    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(len(detected_keypoints[i])):
        cv2<span style="color:#f92672">.</span>circle(frameClone, detected_keypoints[i][j][<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">2</span>], <span style="color:#ae81ff">3</span>, [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">255</span>], <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, cv2<span style="color:#f92672">.</span>LINE_AA)

plt<span style="color:#f92672">.</span>imshow(frameClone) 
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="/post_image/multiple_pose_estimation_keypoint.png" alt="Hình toàn bộ điểm đặc trưng"></p>
<p>Cuối cùng, chúng ta sẽ nối các điểm đặc trưng của các nhân vật thông qua thuật toán Part Affinity Heatmaps. Thuật toán này được đề xuất bởi nhóm tác giả Zhe Cao, Tomas Simon,Shih-En Wei, Yaser Sheikh thuộc phòng thí nghiệm The Robotics Institute trường đại học Carnegie Mellon. Các bạn có nhu cầu có thể tìm hiểu ở <a href="https://arxiv.org/pdf/1611.08050.pdf">https://arxiv.org/pdf/1611.08050.pdf</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
mapIdx <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">16</span>,<span style="color:#ae81ff">17</span>], [<span style="color:#ae81ff">18</span>,<span style="color:#ae81ff">19</span>], [<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">21</span>], [<span style="color:#ae81ff">22</span>,<span style="color:#ae81ff">23</span>], [<span style="color:#ae81ff">24</span>,<span style="color:#ae81ff">25</span>], [<span style="color:#ae81ff">26</span>,<span style="color:#ae81ff">27</span>], [<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">29</span>], [<span style="color:#ae81ff">30</span>,<span style="color:#ae81ff">31</span>], [<span style="color:#ae81ff">32</span>,<span style="color:#ae81ff">33</span>], [<span style="color:#ae81ff">34</span>,<span style="color:#ae81ff">35</span>], [<span style="color:#ae81ff">36</span>,<span style="color:#ae81ff">37</span>], [<span style="color:#ae81ff">38</span>,<span style="color:#ae81ff">39</span>], [<span style="color:#ae81ff">40</span>,<span style="color:#ae81ff">41</span>], [<span style="color:#ae81ff">42</span>,<span style="color:#ae81ff">43</span>]]



colors <span style="color:#f92672">=</span> [ [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">100</span>,<span style="color:#ae81ff">255</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">100</span>,<span style="color:#ae81ff">255</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">255</span>,<span style="color:#ae81ff">255</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">100</span>,<span style="color:#ae81ff">255</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">255</span>,<span style="color:#ae81ff">255</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">100</span>,<span style="color:#ae81ff">255</span>],
         [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">255</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">255</span>,<span style="color:#ae81ff">200</span>,<span style="color:#ae81ff">100</span>], [<span style="color:#ae81ff">255</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">255</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">255</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">255</span>,<span style="color:#ae81ff">200</span>,<span style="color:#ae81ff">100</span>], [<span style="color:#ae81ff">255</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">255</span>],
         [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">255</span>], [<span style="color:#ae81ff">255</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">200</span>,<span style="color:#ae81ff">200</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">255</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">200</span>,<span style="color:#ae81ff">200</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>]]
<span style="color:#75715e"># Find valid connections between the different joints of a all persons present</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getValidPairs</span>(output):
    valid_pairs <span style="color:#f92672">=</span> []
    invalid_pairs <span style="color:#f92672">=</span> []
    n_interp_samples <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
    paf_score_th <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.1</span>
    conf_th <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>
    <span style="color:#75715e"># loop for every POSE_PAIR</span>
    <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(len(mapIdx)):
        <span style="color:#75715e"># A-&gt;B constitute a limb</span>
        pafA <span style="color:#f92672">=</span> output[<span style="color:#ae81ff">0</span>, mapIdx[k][<span style="color:#ae81ff">0</span>], :, :]
        pafB <span style="color:#f92672">=</span> output[<span style="color:#ae81ff">0</span>, mapIdx[k][<span style="color:#ae81ff">1</span>], :, :]
        pafA <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>resize(pafA, (frameWidth, frameHeight))
        pafB <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>resize(pafB, (frameWidth, frameHeight))


        <span style="color:#75715e"># Find the keypoints for the first and second limb</span>
        candA <span style="color:#f92672">=</span> detected_keypoints[POSE_PAIRS[k][<span style="color:#ae81ff">0</span>]]
        candB <span style="color:#f92672">=</span> detected_keypoints[POSE_PAIRS[k][<span style="color:#ae81ff">1</span>]]
        nA <span style="color:#f92672">=</span> len(candA)
        nB <span style="color:#f92672">=</span> len(candB)

        <span style="color:#75715e"># fig=plt.figure(figsize=(8, 8))</span>

        <span style="color:#75715e"># interp_coord = list(zip(np.linspace(candA[0][0], candB[0][0], num=n_interp_samples),</span>
        <span style="color:#75715e">#                                     np.linspace(candA[0][1], candB[0][1], num=n_interp_samples)))</span>

        <span style="color:#75715e"># frameClone1 = frameClone.copy() </span>
        <span style="color:#75715e"># fig.add_subplot(1, 2, 1)</span>
        
        <span style="color:#75715e"># for xx in interp_coord:</span>
        <span style="color:#75715e">#     cv2.circle(frameClone1,(int(xx[0]),int(xx[1])), 3, [0,0,255], -1, cv2.LINE_AA)</span>


        <span style="color:#75715e"># plt.imshow(cv2.cvtColor(frameClone1, cv2.COLOR_BGR2RGB))</span>
        <span style="color:#75715e"># plt.imshow(pafA, alpha=0.5)</span>

        <span style="color:#75715e"># frameClone1 = frameClone.copy() </span>
        <span style="color:#75715e"># fig.add_subplot(1, 2, 2)</span>
        

        

        <span style="color:#75715e"># for xx in interp_coord:</span>
        <span style="color:#75715e">#     cv2.circle(frameClone1,(int(xx[0]),int(xx[1])), 3, [0,0,255], -1, cv2.LINE_AA)</span>
        
        <span style="color:#75715e"># plt.imshow(cv2.cvtColor(frameClone1, cv2.COLOR_BGR2RGB))</span>
        <span style="color:#75715e"># plt.imshow(pafB, alpha=0.5)</span>
        <span style="color:#75715e"># plt.show()</span>



        

        <span style="color:#75715e"># If keypoints for the joint-pair is detected</span>
        <span style="color:#75715e"># check every joint in candA with every joint in candB </span>
        <span style="color:#75715e"># Calculate the distance vector between the two joints</span>
        <span style="color:#75715e"># Find the PAF values at a set of interpolated points between the joints</span>
        <span style="color:#75715e"># Use the above formula to compute a score to mark the connection valid</span>
        
        <span style="color:#66d9ef">if</span>( nA <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">and</span> nB <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>):
            valid_pair <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>zeros((<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">3</span>))
            <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(nA):
                max_j<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>
                maxScore <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
                found <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
                <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(nB):
                    <span style="color:#75715e"># Find d_ij</span>
                    d_ij <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>subtract(candB[j][:<span style="color:#ae81ff">2</span>], candA[i][:<span style="color:#ae81ff">2</span>])
                    norm <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linalg<span style="color:#f92672">.</span>norm(d_ij)
                    <span style="color:#66d9ef">if</span> norm:
                        d_ij <span style="color:#f92672">=</span> d_ij <span style="color:#f92672">/</span> norm
                    <span style="color:#66d9ef">else</span>:
                        <span style="color:#66d9ef">continue</span>
                    <span style="color:#75715e"># Find p(u)</span>
                    interp_coord <span style="color:#f92672">=</span> list(zip(np<span style="color:#f92672">.</span>linspace(candA[i][<span style="color:#ae81ff">0</span>], candB[j][<span style="color:#ae81ff">0</span>], num<span style="color:#f92672">=</span>n_interp_samples),
                                            np<span style="color:#f92672">.</span>linspace(candA[i][<span style="color:#ae81ff">1</span>], candB[j][<span style="color:#ae81ff">1</span>], num<span style="color:#f92672">=</span>n_interp_samples)))
                    <span style="color:#75715e"># Find L(p(u))</span>
                    paf_interp <span style="color:#f92672">=</span> []
                    <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(len(interp_coord)):
                        paf_interp<span style="color:#f92672">.</span>append([pafA[int(round(interp_coord[k][<span style="color:#ae81ff">1</span>])), int(round(interp_coord[k][<span style="color:#ae81ff">0</span>]))],
                                           pafB[int(round(interp_coord[k][<span style="color:#ae81ff">1</span>])), int(round(interp_coord[k][<span style="color:#ae81ff">0</span>]))] ]) 
                    <span style="color:#75715e"># Find E</span>
                    paf_scores <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>dot(paf_interp, d_ij)
                    avg_paf_score <span style="color:#f92672">=</span> sum(paf_scores)<span style="color:#f92672">/</span>len(paf_scores)
                    
                    <span style="color:#75715e"># Check if the connection is valid</span>
                    <span style="color:#75715e"># If the fraction of interpolated vectors aligned with PAF is higher then threshold -&gt; Valid Pair  </span>
                    <span style="color:#66d9ef">if</span> ( len(np<span style="color:#f92672">.</span>where(paf_scores <span style="color:#f92672">&gt;</span> paf_score_th)[<span style="color:#ae81ff">0</span>]) <span style="color:#f92672">/</span> n_interp_samples ) <span style="color:#f92672">&gt;</span> conf_th :
                        <span style="color:#66d9ef">if</span> avg_paf_score <span style="color:#f92672">&gt;</span> maxScore:
                            max_j <span style="color:#f92672">=</span> j
                            maxScore <span style="color:#f92672">=</span> avg_paf_score
                            found <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
                <span style="color:#75715e"># Append the connection to the list</span>
                <span style="color:#66d9ef">if</span> found:            
                    valid_pair <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>append(valid_pair, [[candA[i][<span style="color:#ae81ff">3</span>], candB[max_j][<span style="color:#ae81ff">3</span>], maxScore]], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)

            <span style="color:#75715e"># Append the detected connections to the global list</span>
            valid_pairs<span style="color:#f92672">.</span>append(valid_pair)

            pprint(valid_pair)
        <span style="color:#66d9ef">else</span>: <span style="color:#75715e"># If no keypoints are detected</span>
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;No Connection : k = {}&#34;</span><span style="color:#f92672">.</span>format(k))
            invalid_pairs<span style="color:#f92672">.</span>append(k)
            valid_pairs<span style="color:#f92672">.</span>append([])
    pprint(valid_pairs)
    <span style="color:#66d9ef">return</span> valid_pairs, invalid_pairs

<span style="color:#75715e"># This function creates a list of keypoints belonging to each person</span>
<span style="color:#75715e"># For each detected valid pair, it assigns the joint(s) to a person</span>
<span style="color:#75715e"># It finds the person and index at which the joint should be added. This can be done since we have an id for each joint</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getPersonwiseKeypoints</span>(valid_pairs, invalid_pairs):
    <span style="color:#75715e"># the last number in each row is the overall score </span>
    personwiseKeypoints <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>ones((<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">19</span>))

    <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(len(mapIdx)):
        <span style="color:#66d9ef">if</span> k <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> invalid_pairs:
            partAs <span style="color:#f92672">=</span> valid_pairs[k][:,<span style="color:#ae81ff">0</span>]
            partBs <span style="color:#f92672">=</span> valid_pairs[k][:,<span style="color:#ae81ff">1</span>]
            indexA, indexB <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(POSE_PAIRS[k])

            <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(valid_pairs[k])): 
                found <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
                person_idx <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
                <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(len(personwiseKeypoints)):
                    <span style="color:#66d9ef">if</span> personwiseKeypoints[j][indexA] <span style="color:#f92672">==</span> partAs[i]:
                        person_idx <span style="color:#f92672">=</span> j
                        found <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
                        <span style="color:#66d9ef">break</span>

                <span style="color:#66d9ef">if</span> found:
                    personwiseKeypoints[person_idx][indexB] <span style="color:#f92672">=</span> partBs[i]
                    personwiseKeypoints[person_idx][<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">+=</span> keypoints_list[partBs[i]<span style="color:#f92672">.</span>astype(int), <span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> valid_pairs[k][i][<span style="color:#ae81ff">2</span>]

                <span style="color:#75715e"># if find no partA in the subset, create a new subset</span>
                <span style="color:#66d9ef">elif</span> <span style="color:#f92672">not</span> found <span style="color:#f92672">and</span> k <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">17</span>:
                    row <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>ones(<span style="color:#ae81ff">19</span>)
                    row[indexA] <span style="color:#f92672">=</span> partAs[i]
                    row[indexB] <span style="color:#f92672">=</span> partBs[i]
                    <span style="color:#75715e"># add the keypoint_scores for the two keypoints and the paf_score </span>
                    row[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> sum(keypoints_list[valid_pairs[k][i,:<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>astype(int), <span style="color:#ae81ff">2</span>]) <span style="color:#f92672">+</span> valid_pairs[k][i][<span style="color:#ae81ff">2</span>]
                    personwiseKeypoints <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>vstack([personwiseKeypoints, row])
    <span style="color:#66d9ef">return</span> personwiseKeypoints

valid_pairs, invalid_pairs <span style="color:#f92672">=</span> getValidPairs(output)

personwiseKeypoints <span style="color:#f92672">=</span> getPersonwiseKeypoints(valid_pairs, invalid_pairs)


<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(nPoints<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
    <span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> range(len(personwiseKeypoints)):
       
        index <span style="color:#f92672">=</span> personwiseKeypoints[n][np<span style="color:#f92672">.</span>array(POSE_PAIRS[i])]
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">in</span> index:
            <span style="color:#66d9ef">continue</span>
        B <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>int32(keypoints_list[index<span style="color:#f92672">.</span>astype(int), <span style="color:#ae81ff">0</span>])
        A <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>int32(keypoints_list[index<span style="color:#f92672">.</span>astype(int), <span style="color:#ae81ff">1</span>])
        cv2<span style="color:#f92672">.</span>line(frameClone, (B[<span style="color:#ae81ff">0</span>], A[<span style="color:#ae81ff">0</span>]), (B[<span style="color:#ae81ff">1</span>], A[<span style="color:#ae81ff">1</span>]), colors[i], <span style="color:#ae81ff">3</span>, cv2<span style="color:#f92672">.</span>LINE_AA)
       
        
        
plt<span style="color:#f92672">.</span>imshow(frameClone)
    <span style="color:#75715e"># plt.imshow(mapMask, alpha=0.5)</span>
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="/post_image/multiple_pose_estimation_t-ara_finalresult.png" alt="Hình kết quả cuối cùng"></p>
<p>Hẹn gặp lại các bạn ở những bài viết tiếp theo.</p>
<p>Bài viết này được viết dựa vào nguồn <a href="https://www.learnopencv.com/multi-person-pose-estimation-in-opencv-using-openpose/">https://www.learnopencv.com/multi-person-pose-estimation-in-opencv-using-openpose/</a> của tác giả VIKAS GUPTA. Tôi sử dụng tập model và hình ảnh khác với bài viết nguyên gốc của tác giả.</p>

  </div>
  
			</div>
  <footer class="col-md-10  mx-auto">
  <div >
  <div class="fb-like" data-share="true"  data-width="450"  data-show-faces="true">
</div> </p></div>
    <ul class="stats list-unstyled">
 
    
  <li class="tags">
    <ul class="list-inline">
       
            
            
                <i class="fa fa-tags"></i>
                
                
                <li class="list-inline-item"><a class="article-category-link" href="/tags/machine-learning">Machine learning</a></li>
                
                
                <li class="list-inline-item"><a class="article-category-link" href="/tags/deeplearning">Deeplearning</a></li>
                
                
                <li class="list-inline-item"><a class="article-category-link" href="/tags/multiple-pose-estimation">multiple pose estimation</a></li>
                
            
        
    </ul>
  </li>
  
</ul>

	</div>
  </footer>
  <hr/>
<div class="infinite-container featured-task col-md-8 mx-auto">
<div class="titlerelate">Bài viết khác</div>

<div class="card-deck card-break infinite-item">



    
        <div class="card  col-md-6" style="padding-top:15px;">
		<a href="/blog/2018-10-04-deep-learning-base-human-pose-estimation/"
                class="button big previous">
		
		<img class="card-img-top lazy" src="../../post_image/post_estimator_shark.gif" width="100" />
		<div class="card-body">
		<h5 class="card-title">
		Deep Learning based Human Pose Estimation using OpenCV
				</h5>
				</div>
				</a>
				</div>
    

    
        <div class="card  col-md-6"  style="padding-top:15px;">
		<a href="/blog/2018-10-08-mask-rnn/"
                class="button big previous">
		
		<img class="card-img-top lazy" src="../../post_image/maxresdefault.jpg" width="100" />
		
		<div class="card-body">
		<h5 class="card-title">
		Mask R-CNN trong bài toán nhận dạng và phân vùng đối tượng
				</h5>
				</div>
				</a>
				</div>
    

</div>
</div>



<div class="fb-comments" data-href="" data-width="" data-numposts="5"></div>

    <article class="post">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "phamduytung" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </article>



</article>


		
    </main>
    
	
	</div>
    
	<hr>
  <footer class="footer">
  <div class="container text-center">
    
    <p class="copyright">
      
        &copy; 2020
        
          Phạm Duy Tùng Machine Learning Blog
        
      
     
    </p>
	</div>
  </footer>
    
    

    
      
    

    
      
      
      
        <script src="//cdn.bootcss.com/highlight.js/9.15.8/highlight.min.js"></script>
        
        
        
        <script src="//cdn.bootcss.com/highlight.js/9.15.8/languages/python.min.js"></script>
        <script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>
      
    
    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/skel/3.0.1/skel.min.js"></script>
     

   <script src="/js/jquery-2.2.4.min.js"></script>
   
    <script src="/js/bootstrap.min.js"></script>
      <script src="/js/util.js"></script>
      <script src="/js/main.js"></script>
     
    

    
      
        
      
    
	
    
    
      
<script async
src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


	  
	  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-114911596-1"  data-cfasync="false"></script>
<script  data-cfasync="false">
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-114911596-1');
</script>
<script src="https://cdn.jsdelivr.net/npm/intersection-observer@0.5.1/intersection-observer.js"  data-cfasync="false"></script>
<script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@12.0.0/dist/lazyload.min.js"  data-cfasync="false"></script>
 <script  src="/js/jquery.amlich.js" data-cfasync="false" ></script>
	   <script  type="text/javascript"  data-cfasync="false">

  function getcontent(){
 

   

             var myLazyLoad = new LazyLoad({
    elements_selector: ".lazy"
});
                }
            
			
			$(document).ready(function(){
      getcontent();
      $('#calander').amLich({
  type: 'calendar', 
  tableWidth: '100%' 
});
  

			}); 
</script>
 

  </body>
</html>

