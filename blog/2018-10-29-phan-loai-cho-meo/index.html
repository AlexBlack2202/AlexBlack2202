<!DOCTYPE HTML>

<html>
    <head>
        <script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "\/"
        },
        "articleSection" : "blog",
        "name" : "Phân loại chó mèo sử dụng pretrain model",
        "headline" : "Phân loại chó mèo sử dụng pretrain model",
        "description" : "Ở bài viết này, chúng ta đề cập đến vấn đề sử dụng pretrain model của kares trong bài toán phân loại chó mèo.",
        "inLanguage" : "en",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2018",
        "datePublished": "2018-10-29 00:19:00 \x2b0300 \x2b0300",
        "dateModified" : "2018-10-29 00:19:00 \x2b0300 \x2b0300",
        "url" : "\/blog\/2018-10-29-phan-loai-cho-meo\/",
        "wordCount" : "4506",
        "keywords" : [ "Machine learning","Deeplearning","dog cat","Blog" ]
    }
    </script>
        
            
                <title>Phân loại chó mèo sử dụng pretrain model</title>
            
        

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        
		<meta name="generator" content="Phạm Duy Tùng" />
        
  
    
  

  

  
  
  
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content='/favicon/mstile.png'>
  <meta name="application-name" content="Phạm Duy Tùng Machine Learning Blog">
  <meta name="msapplication-tooltip" content="Blog ML của Phạm Duy Tùng và Đặng Thị Hằng">
   
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">



        
            <meta name="author" content="Phạm Duy Tùng">
        
        
            <meta name="description" content="Ở bài viết này, chúng ta đề cập đến vấn đề sử dụng pretrain model của kares trong bài toán phân loại chó mèo.">
        

        <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Phân loại chó mèo sử dụng pretrain model"/>
<meta name="twitter:description" content="Ở bài viết này, chúng ta đề cập đến vấn đề sử dụng pretrain model của kares trong bài toán phân loại chó mèo."/>
<meta name="twitter:site" content="@example"/>

        <meta property="og:title" content="Phân loại chó mèo sử dụng pretrain model" />
<meta property="og:description" content="Ở bài viết này, chúng ta đề cập đến vấn đề sử dụng pretrain model của kares trong bài toán phân loại chó mèo." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/2018-10-29-phan-loai-cho-meo/" />
<meta property="article:published_time" content="2018-10-29T00:19:00+03:00" />
<meta property="article:modified_time" content="2018-10-29T00:19:00+03:00" />

        <meta property="og:image" content="//images/logo.png">
        <meta property="og:image:type" content="image/png">
        <meta property="og:image:width" content="512">
        <meta property="og:image:height" content="512">
        <meta itemprop="name" content="Phân loại chó mèo sử dụng pretrain model">
<meta itemprop="description" content="Ở bài viết này, chúng ta đề cập đến vấn đề sử dụng pretrain model của kares trong bài toán phân loại chó mèo.">
<meta itemprop="datePublished" content="2018-10-29T00:19:00&#43;03:00" />
<meta itemprop="dateModified" content="2018-10-29T00:19:00&#43;03:00" />
<meta itemprop="wordCount" content="4506">



<meta itemprop="keywords" content="Machine learning,Deeplearning,dog cat," />
        

        
            
        

        
        
          
			
			 <link rel="stylesheet" href="/css/font-awesome.min.css">
			 <link rel="stylesheet" href="/css/bootstrap.min.css">


          
            <link rel="stylesheet" href="/css/academicons.min.css">
        

        
            
                
            
        


  
    
    <link href='//cdn.bootcss.com/highlight.js/9.15.8/styles/github.min.css' rel='stylesheet' type='text/css' />
  


      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-114911596-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

	  
	  <style>
	  
	  body{
font-family: Helvetica,Arial,sans-serif;
}

.card{
	margin-bottom: 10px;
}

#disqus_thread{
padding: 0 5px;
}

.item-header{
padding: 0;
}

.single-content-img{
width: 100%;
    max-height: 450px !important;
    background-size: cover;
    display: block;
    background-position: center;
}

.thumbnail {
    position: relative;
}

.caption {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
	background: rgba(0, 0, 0, 0.25);
	text-align:left;
}

.caption .title{
	font-size: 1.6em;
    line-height: 1.4em;
    top: 0;
	margin-left:20px;
	margin-top:20px;
	
}

.caption .title-caption{
margin-left:10px;
}

#content p{
text-align: justify;
    line-height: 1.9;
    font-size: 12pt;
}

#content img{
	display: block;
    margin-left: auto;
margin-right: auto;
max-width:98%;
}

img + strong {
    font-style: normal;
    display: inherit;
    text-align: center;
}
.img-news{
max-height:150px;
width:100%;
}

.news-tittle{
	padding-top:15px;
	text-align:justify;
}

.author{
	color: orange;
}
.author-inline{
	color: orange;
}

.adv{
height:18px;
}

h1, h2, h3, h4{
padding-bottom: 10px;
    font-weight: bold;
}

h1{
color: #d04764}


h2{
color: orange}

h3{
color: #d04764}

h4{
color: #8dec89}

.hljs{
    white-space: pre-wrap;
    white-space: -moz-pre-wrap;
    white-space: -pre-wrap;
    white-space: -o-pre-wrap;
    word-wrap: break-word;}
	  .titledetail {
    display: block;
    overflow: hidden;
    line-height: 53px;
    font-size: 45px;
    color: #333;
    font-family: 'Roboto Condensed',sans-serif;
    font-weight: 600;
    margin: auto;
	padding:25px 0;
	text-align:justify;
}

.newsrelate {
    display: block;
    overflow: hidden;
	 list-style:none;
}
a ,a:hover{
    text-decoration: none;
}
.newsrelate li {
    float: left;
    overflow: hidden;
    width: 30%;
    margin-left: 2.5%;
    margin-bottom: 15px;
}

.newsrelate li a {
    display: block;
    overflow: hidden;
}

.newsrelate li h3 {
    display: block;
    overflow: hidden;
    line-height: 1.3em;
    font-size: 16pt;
    color: #333;
    line-height: 22px;
    font-weight: 300;
    font-family: Arial,Helvetica,sans-serif;
    width: auto;
    margin: 5px auto;
}

.titlerelate {
    overflow: hidden;
    font-size: 18px;
    font-weight: 600;
    color: #333;
    font-family: 'Roboto Condensed',sans-serif;
    line-height: 32px;
    text-transform: uppercase;
}


	  </style>
	  
    </head>
    <body>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '1546237302193677',
      xfbml      : true,
      version    : 'v5.0'
    });
    FB.AppEvents.logPageView();
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "https://connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>
<div id="fb-root"></div>
<script async defer crossorigin="anonymous" src="https://connect.facebook.net/vi_VN/sdk.js#xfbml=1&version=v5.0&appId=1853483258232756&autoLogAppEvents=1"></script>
      
      

    
    
<header id="header"  style="background: #790014; color: hsla(0,0%,100%,1);">
<div class="container">
    <nav class="navbar navbar-expand-md navbar-dark">
	
	<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav mr-auto">
            
                <li class="nav-item">
                    <a class='nav-link' href="/blog">
                            <i class="fa fa-home active">&nbsp;</i>Home
                    </a>
                </li>
            
                <li class="nav-item">
                    <a class='nav-link' href="/news/">
                            <i class="fa fa-list">&nbsp;</i>News
                    </a>
                </li>
            
                <li class="nav-item">
                    <a class='nav-link' href="/xem-truyen/">
                            <i class="fa fa-id-card-o">&nbsp;</i>Truyện
                    </a>
                </li>
            
        </ul>
    </nav>
    </div></div>
</header>


   
    
	<div class="container">
	<div class="adv"></div>
	<div>
    <main role="main" >
	
        
        
        <article class="col-md-10 col-lg-9 mx-auto">
  


        
		 <div class="">
            <h3 class="titledetail">Phân loại chó mèo sử dụng pretrain model</h3>
			
			<div class="col-md-12">
			 
			  <time class="published"
            datetime='2018-10-29'>
            29/10/2018</time>
		 - 
			   <span class="author">Phạm Duy Tùng</span>
			   
			
		<div class="thumbnail text-center">
		 <img class="img-fluid single-content-img lazy" src="../../post_image/dot_cat_classification.jpg" />
		
			</div>
			 
            
        
       



  

  

  <div id="content" class="col-md-10 mx-auto">
    <h2 id="lời-mở-đầu">Lời mở đầu</h2>
<p>Bài toán phân loại chó mèo là bài toán khá cũ tại thời điểm hiện tại. Tuy nhiên, đối với các bạn mới bước chân vào con đường machine learning thì đây là một trong những bài toán cơ bản để các bạn thực hành sử dụng và tìm hiểu thư viện mà mình đang có. Ở đây, chúng ta sẽ sử dụng pretrain model có sẵn của kares áp dụng trên tập dữ liệu. Các bạn có thể download tập dữ liệu train và test ở địa chỉ <a href="https://www.kaggle.com/c/dogs-vs-cats/download/train.zip">https://www.kaggle.com/c/dogs-vs-cats/download/train.zip</a> và <a href="https://www.kaggle.com/c/dogs-vs-cats/download/test1.zip">https://www.kaggle.com/c/dogs-vs-cats/download/test1.zip</a> để bắt đầu thực hiện.</p>
<h2 id="thực-hiện">Thực hiện</h2>
<p>Sau khi giải nén dữ liệu, ta thấy rằng thư mục train có cấu trúc đặt trên sẽ là label.số thứ tự.jpg. Trong đó label có thể là dog hoặc cat, số thứ tự tăng dần từ 0 đến &hellip;. 12499. Để đảm bảo đúng với mô hình, ta phải cấu trúc lại dữ liệu thành dạng.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data_dir<span style="color:#f92672">/</span>classname1<span style="color:#f92672">/</span><span style="color:#f92672">*</span><span style="color:#f92672">.</span><span style="color:#f92672">*</span>
data_dir<span style="color:#f92672">/</span>classname2<span style="color:#f92672">/</span><span style="color:#f92672">*</span><span style="color:#f92672">.</span><span style="color:#f92672">*</span>
<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
</code></pre></div><p>Vì vậy, ta tạo ra thư mục cat và copy những file bắt đầu bằng cat.* vào thư mục cat. Làm tương tự với thư mục dog.</p>
<p>Đầu tiên, các bạn download file pretrain model, giải nén ra và để ở đâu đó trong ổ cứng của máy bạn. Đường dẫn file pretrain model các bạn có thể download ở <a href="http://download.tensorflow.org/models/object_detection/mask_rcnn_inception_v2_coco_2018_01_28.tar.gz">http://download.tensorflow.org/models/object_detection/mask_rcnn_inception_v2_coco_2018_01_28.tar.gz</a>. Các bạn có thể download các file pretrain khác nếu có hứng thú tìm hiểu.</p>
<p>Tiếp theo, chúng ta sẽ load dataset lên và tranform nó để đưa vào huấn luyện.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> sys
<span style="color:#f92672">import</span> os
<span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> defaultdict
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> scipy.misc


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">preprocess_input</span>(x0):
    x <span style="color:#f92672">=</span> x0 <span style="color:#f92672">/</span> <span style="color:#ae81ff">255.</span>
    x <span style="color:#f92672">-</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>
    x <span style="color:#f92672">*</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">2.</span>
    <span style="color:#66d9ef">return</span> x


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">reverse_preprocess_input</span>(x0):
    x <span style="color:#f92672">=</span> x0 <span style="color:#f92672">/</span> <span style="color:#ae81ff">2.0</span>
    x <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>
    x <span style="color:#f92672">*</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">255.</span>
    <span style="color:#66d9ef">return</span> x


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dataset</span>(base_dir, n):
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">base dir: </span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">+</span>base_dir)
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">n: </span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">+</span>str(n))
    n <span style="color:#f92672">=</span> int(n)
    d <span style="color:#f92672">=</span> defaultdict(list)
    <span style="color:#66d9ef">for</span> root, subdirs, files <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>walk(base_dir):
        <span style="color:#66d9ef">for</span> filename <span style="color:#f92672">in</span> files:
            file_path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(root, filename)
            <span style="color:#66d9ef">assert</span> file_path<span style="color:#f92672">.</span>startswith(base_dir)
            
            suffix <span style="color:#f92672">=</span> file_path[len(base_dir):]
            
            suffix <span style="color:#f92672">=</span> suffix<span style="color:#f92672">.</span>lstrip(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">/</span><span style="color:#e6db74">&#34;</span>)
            suffix <span style="color:#f92672">=</span> suffix<span style="color:#f92672">.</span>lstrip(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#34;</span>)
            <span style="color:#66d9ef">if</span>(suffix<span style="color:#f92672">.</span>find(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">/</span><span style="color:#e6db74">&#39;</span>)<span style="color:#f92672">&gt;</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>): <span style="color:#75715e">#linux</span>
                label <span style="color:#f92672">=</span> suffix<span style="color:#f92672">.</span>split(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">/</span><span style="color:#e6db74">&#34;</span>)[<span style="color:#ae81ff">0</span>]
            <span style="color:#66d9ef">else</span>: <span style="color:#75715e">#window</span>
                label <span style="color:#f92672">=</span> suffix<span style="color:#f92672">.</span>split(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#34;</span>)[<span style="color:#ae81ff">0</span>]
            d[label]<span style="color:#f92672">.</span>append(file_path)
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">walk directory complete</span><span style="color:#e6db74">&#34;</span>)
    tags <span style="color:#f92672">=</span> sorted(d<span style="color:#f92672">.</span>keys())

    processed_image_count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    useful_image_count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>

    X <span style="color:#f92672">=</span> []
    y <span style="color:#f92672">=</span> []

    <span style="color:#66d9ef">for</span> class_index, class_name <span style="color:#f92672">in</span> enumerate(tags):
        filenames <span style="color:#f92672">=</span> d[class_name]
        <span style="color:#66d9ef">for</span> filename <span style="color:#f92672">in</span> filenames:
            processed_image_count <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
            <span style="color:#66d9ef">if</span> processed_image_count<span style="color:#f92672">%</span><span style="color:#ae81ff">100</span> <span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>:
                <span style="color:#66d9ef">print</span>(class_name<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">process: </span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">+</span>str(processed_image_count)<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">+</span>str(len(d[class_name])))
            img <span style="color:#f92672">=</span> scipy<span style="color:#f92672">.</span>misc<span style="color:#f92672">.</span>imread(filename)
            height, width, chan <span style="color:#f92672">=</span> img<span style="color:#f92672">.</span>shape
            <span style="color:#66d9ef">assert</span> chan <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>
            aspect_ratio <span style="color:#f92672">=</span> float(max((height, width))) <span style="color:#f92672">/</span> min((height, width))
            <span style="color:#66d9ef">if</span> aspect_ratio <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">2</span>:
                <span style="color:#66d9ef">continue</span>
            <span style="color:#75715e"># We pick the largest center square.</span>
            centery <span style="color:#f92672">=</span> height <span style="color:#f92672">/</span><span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
            centerx <span style="color:#f92672">=</span> width <span style="color:#f92672">/</span><span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
            radius <span style="color:#f92672">=</span> min((centerx, centery))
            img <span style="color:#f92672">=</span> img[centery<span style="color:#f92672">-</span>radius:centery<span style="color:#f92672">+</span>radius, centerx<span style="color:#f92672">-</span>radius:centerx<span style="color:#f92672">+</span>radius]
            img <span style="color:#f92672">=</span> scipy<span style="color:#f92672">.</span>misc<span style="color:#f92672">.</span>imresize(img, size<span style="color:#f92672">=</span>(n, n), interp<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">bilinear</span><span style="color:#e6db74">&#39;</span>)
            X<span style="color:#f92672">.</span>append(img)
            y<span style="color:#f92672">.</span>append(class_index)
            useful_image_count <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">processed </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">, used </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (processed_image_count, useful_image_count))

    X <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(X)<span style="color:#f92672">.</span>astype(np<span style="color:#f92672">.</span>float32)
    <span style="color:#75715e">#X = X.transpose((0, 3, 1, 2))</span>
    X <span style="color:#f92672">=</span> preprocess_input(X)
    y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(y)

    perm <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>permutation(len(y))
    X <span style="color:#f92672">=</span> X[perm]
    y <span style="color:#f92672">=</span> y[perm]

    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">classes:</span><span style="color:#e6db74">&#34;</span>,end<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74"> </span><span style="color:#e6db74">&#34;</span>)
    <span style="color:#66d9ef">for</span> class_index, class_name <span style="color:#f92672">in</span> enumerate(tags):
        <span style="color:#66d9ef">print</span>(class_name, sum(y<span style="color:#f92672">==</span>class_index),end<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74"> </span><span style="color:#e6db74">&#34;</span>)
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">X shape: </span><span style="color:#e6db74">&#34;</span>,X<span style="color:#f92672">.</span>shape)

    <span style="color:#66d9ef">return</span> X, y, tags
</code></pre></div><p>Đoạn code trên khá đơn giản và dễ hiểu. Lưu ý ở đây là với những bức ảnh có tỷ lệ width và height &gt; 2 thì mình sẽ loại chúng ra khỏi tập dữ liệu.</p>
<p>Tiếp theo, chúng ta sẽ xây dựng mô hình dựa trên mô hình InceptionV3 có sẵn, thêm một lớp softmax ở cuối để phân lớp dữ liệu, chúng ta sẽ huấn luyện lớp softmax này. Các lớp trước lớp softmax này sẽ bị đóng băng (không cập nhật trọng số trong quá trình huấn luyện ).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#75715e"># create the base pre-trained model</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">build_model</span>(nb_classes):
    base_model <span style="color:#f92672">=</span> InceptionV3(weights<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">imagenet</span><span style="color:#e6db74">&#39;</span>, include_top<span style="color:#f92672">=</span>False)

    <span style="color:#75715e"># add a global spatial average pooling layer</span>
    x <span style="color:#f92672">=</span> base_model<span style="color:#f92672">.</span>output
    x <span style="color:#f92672">=</span> GlobalAveragePooling2D()(x)
    <span style="color:#75715e"># let&#39;s add a fully-connected layer</span>
    x <span style="color:#f92672">=</span> Dense(<span style="color:#ae81ff">1024</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">relu</span><span style="color:#e6db74">&#39;</span>)(x)
    <span style="color:#75715e"># and a logistic layer</span>
    predictions <span style="color:#f92672">=</span> Dense(nb_classes, activation<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">softmax</span><span style="color:#e6db74">&#39;</span>)(x)

    <span style="color:#75715e"># this is the model we will train</span>
    model <span style="color:#f92672">=</span> Model(inputs<span style="color:#f92672">=</span>base_model<span style="color:#f92672">.</span>input, outputs<span style="color:#f92672">=</span>predictions)

    <span style="color:#75715e"># first: train only the top layers (which were randomly initialized)</span>
    <span style="color:#75715e"># i.e. freeze all convolutional InceptionV3 layers</span>
    <span style="color:#66d9ef">for</span> layer <span style="color:#f92672">in</span> base_model<span style="color:#f92672">.</span>layers:
        layer<span style="color:#f92672">.</span>trainable <span style="color:#f92672">=</span> False

    <span style="color:#75715e"># compile the model (should be done *after* setting layers to non-trainable)</span>
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">starting model compile</span><span style="color:#e6db74">&#34;</span>)
    compile(model)
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">model compile done</span><span style="color:#e6db74">&#34;</span>)
    <span style="color:#66d9ef">return</span> model
	
</code></pre></div><p>Visualize một chút xíu về kiến trúc inceptionV3 mình đang dùng.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param <span style="color:#75715e">#     Connected to</span>
<span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span>
input_1 (InputLayer)            (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">864</span>         input_1[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">96</span>          conv2d_1[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>           batch_normalization_1[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">9216</span>        activation_1[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">96</span>          conv2d_2[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>           batch_normalization_2[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">18432</span>       activation_2[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">192</span>         conv2d_3[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">0</span>           batch_normalization_3[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">0</span>           activation_3[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, None, None, <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">5120</span>        max_pooling2d_1[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, None, None, <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">240</span>         conv2d_4[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, None, None, <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">0</span>           batch_normalization_4[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">138240</span>      activation_4[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_5[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_5[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           activation_5[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">12288</span>       max_pooling2d_2[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">192</span>         conv2d_9[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">0</span>           batch_normalization_9[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, None, None, <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">9216</span>        max_pooling2d_2[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">55296</span>       activation_9[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, None, None, <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">144</span>         conv2d_7[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">288</span>         conv2d_10[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, None, None, <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">0</span>           batch_normalization_7[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">0</span>           batch_normalization_10[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           max_pooling2d_2[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">12288</span>       max_pooling2d_2[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">76800</span>       activation_7[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">82944</span>       activation_10[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">6144</span>        average_pooling2d_1[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">192</span>         conv2d_6[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">192</span>         conv2d_8[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">288</span>         conv2d_11[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">96</span>          conv2d_12[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">0</span>           batch_normalization_6[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">0</span>           batch_normalization_8[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">0</span>           batch_normalization_11[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>           batch_normalization_12[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
mixed0 (Concatenate)            (None, None, None, <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0</span>           activation_6[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_8[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_11[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_12[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">16384</span>       mixed0[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">192</span>         conv2d_16[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">0</span>           batch_normalization_16[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, None, None, <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">12288</span>       mixed0[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">55296</span>       activation_16[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, None, None, <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">144</span>         conv2d_14[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">288</span>         conv2d_17[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, None, None, <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">0</span>           batch_normalization_14[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">0</span>           batch_normalization_17[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, None, None, <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0</span>           mixed0[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">16384</span>       mixed0[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">76800</span>       activation_14[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">82944</span>       activation_17[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">16384</span>       average_pooling2d_2[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">192</span>         conv2d_13[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">192</span>         conv2d_15[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">288</span>         conv2d_18[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">192</span>         conv2d_19[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">0</span>           batch_normalization_13[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">0</span>           batch_normalization_15[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">0</span>           batch_normalization_18[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">0</span>           batch_normalization_19[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
mixed1 (Concatenate)            (None, None, None, <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0</span>           activation_13[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_15[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_18[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_19[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">18432</span>       mixed1[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_23 (BatchNo (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">192</span>         conv2d_23[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">0</span>           batch_normalization_23[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, None, None, <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">13824</span>       mixed1[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">55296</span>       activation_23[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_21 (BatchNo (None, None, None, <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">144</span>         conv2d_21[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_24 (BatchNo (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">288</span>         conv2d_24[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, None, None, <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">0</span>           batch_normalization_21[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">0</span>           batch_normalization_24[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, None, None, <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0</span>           mixed1[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">18432</span>       mixed1[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">76800</span>       activation_21[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_25 (Conv2D)              (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">82944</span>       activation_24[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_26 (Conv2D)              (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">18432</span>       average_pooling2d_3[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_20 (BatchNo (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">192</span>         conv2d_20[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_22 (BatchNo (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">192</span>         conv2d_22[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_25 (BatchNo (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">288</span>         conv2d_25[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_26 (BatchNo (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">192</span>         conv2d_26[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">0</span>           batch_normalization_20[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">0</span>           batch_normalization_22[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">0</span>           batch_normalization_25[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">0</span>           batch_normalization_26[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
mixed2 (Concatenate)            (None, None, None, <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0</span>           activation_20[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_22[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_25[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_26[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_28 (Conv2D)              (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">18432</span>       mixed2[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_28 (BatchNo (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">192</span>         conv2d_28[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, None, None, <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">0</span>           batch_normalization_28[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_29 (Conv2D)              (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">55296</span>       activation_28[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_29 (BatchNo (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">288</span>         conv2d_29[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">0</span>           batch_normalization_29[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_27 (Conv2D)              (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">995328</span>      mixed2[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_30 (Conv2D)              (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">82944</span>       activation_29[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_27 (BatchNo (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1152</span>        conv2d_27[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_30 (BatchNo (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">288</span>         conv2d_30[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>           batch_normalization_27[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, None, None, <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">0</span>           batch_normalization_30[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, None, None, <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0</span>           mixed2[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
mixed3 (Concatenate)            (None, None, None, <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">0</span>           activation_27[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_30[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 max_pooling2d_3[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_35 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">98304</span>       mixed3[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_35 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">384</span>         conv2d_35[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_35[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_36 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">114688</span>      activation_35[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_36 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">384</span>         conv2d_36[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_36[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_32 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">98304</span>       mixed3[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_37 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">114688</span>      activation_36[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_32 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">384</span>         conv2d_32[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_37 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">384</span>         conv2d_37[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_32[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_37[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_33 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">114688</span>      activation_32[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_38 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">114688</span>      activation_37[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_33 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">384</span>         conv2d_33[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_38 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">384</span>         conv2d_38[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_33[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_38 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_38[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, None, None, <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">0</span>           mixed3[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_31 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">147456</span>      mixed3[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_34 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">172032</span>      activation_33[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_39 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">172032</span>      activation_38[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_40 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">147456</span>      average_pooling2d_4[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_31 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_31[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_34 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_34[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_39 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_39[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_40 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_40[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_31[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_34[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_39[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_40 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_40[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
mixed4 (Concatenate)            (None, None, None, <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">0</span>           activation_31[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_34[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_39[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_40[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_45 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">122880</span>      mixed4[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_45 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">480</span>         conv2d_45[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_45 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_45[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_46 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">179200</span>      activation_45[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_46 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">480</span>         conv2d_46[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_46[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_42 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">122880</span>      mixed4[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_47 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">179200</span>      activation_46[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_42 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">480</span>         conv2d_42[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_47 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">480</span>         conv2d_47[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_42[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_47 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_47[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_43 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">179200</span>      activation_42[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_48 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">179200</span>      activation_47[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_43 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">480</span>         conv2d_43[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_48 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">480</span>         conv2d_48[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_43[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_48[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
average_pooling2d_5 (AveragePoo (None, None, None, <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">0</span>           mixed4[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_41 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">147456</span>      mixed4[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_44 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">215040</span>      activation_43[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_49 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">215040</span>      activation_48[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_50 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">147456</span>      average_pooling2d_5[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_41 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_41[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_44 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_44[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_49 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_49[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_50 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_50[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_41[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_44[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_49 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_49[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_50 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_50[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
mixed5 (Concatenate)            (None, None, None, <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">0</span>           activation_41[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_44[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_49[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_50[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_55 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">122880</span>      mixed5[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_55 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">480</span>         conv2d_55[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_55 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_55[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_56 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">179200</span>      activation_55[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_56 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">480</span>         conv2d_56[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_56 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_56[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_52 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">122880</span>      mixed5[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_57 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">179200</span>      activation_56[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_52 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">480</span>         conv2d_52[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_57 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">480</span>         conv2d_57[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_52 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_52[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_57 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_57[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_53 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">179200</span>      activation_52[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_58 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">179200</span>      activation_57[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_53 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">480</span>         conv2d_53[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_58 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">480</span>         conv2d_58[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_53 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_53[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_58 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_58[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
average_pooling2d_6 (AveragePoo (None, None, None, <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">0</span>           mixed5[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_51 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">147456</span>      mixed5[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_54 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">215040</span>      activation_53[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_59 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">215040</span>      activation_58[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_60 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">147456</span>      average_pooling2d_6[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_51 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_51[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_54 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_54[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_59 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_59[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_60 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_60[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_51 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_51[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_54 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_54[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_59 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_59[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_60 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_60[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
mixed6 (Concatenate)            (None, None, None, <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">0</span>           activation_51[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_54[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_59[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_60[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_65 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">147456</span>      mixed6[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_65 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_65[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_65 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_65[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_66 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">258048</span>      activation_65[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_66 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_66[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_66 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_66[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_62 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">147456</span>      mixed6[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_67 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">258048</span>      activation_66[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_62 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_62[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_67 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_67[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_62 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_62[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_67 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_67[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_63 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">258048</span>      activation_62[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_68 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">258048</span>      activation_67[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_63 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_63[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_68 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_68[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_63 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_63[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_68 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_68[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
average_pooling2d_7 (AveragePoo (None, None, None, <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">0</span>           mixed6[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_61 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">147456</span>      mixed6[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_64 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">258048</span>      activation_63[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_69 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">258048</span>      activation_68[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_70 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">147456</span>      average_pooling2d_7[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_61 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_61[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_64 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_64[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_69 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_69[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_70 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_70[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_61 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_61[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_64 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_64[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_69 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_69[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_70 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_70[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
mixed7 (Concatenate)            (None, None, None, <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">0</span>           activation_61[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_64[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_69[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_70[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_73 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">147456</span>      mixed7[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_73 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_73[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_73 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_73[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_74 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">258048</span>      activation_73[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_74 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_74[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_74 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_74[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_71 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">147456</span>      mixed7[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_75 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">258048</span>      activation_74[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_71 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_71[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_75 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_75[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_71 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_71[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_75 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_75[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_72 (Conv2D)              (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">552960</span>      activation_71[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_76 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">331776</span>      activation_75[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_72 (BatchNo (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">960</span>         conv2d_72[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_76 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_76[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_72 (Activation)      (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>           batch_normalization_72[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_76 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_76[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, None, None, <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">0</span>           mixed7[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
mixed8 (Concatenate)            (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           activation_72[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_76[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 max_pooling2d_4[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_81 (Conv2D)              (None, None, None, <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">573440</span>      mixed8[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_81 (BatchNo (None, None, None, <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">1344</span>        conv2d_81[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_81 (Activation)      (None, None, None, <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">0</span>           batch_normalization_81[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_78 (Conv2D)              (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">491520</span>      mixed8[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_82 (Conv2D)              (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1548288</span>     activation_81[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_78 (BatchNo (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1152</span>        conv2d_78[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_82 (BatchNo (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1152</span>        conv2d_82[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_78 (Activation)      (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>           batch_normalization_78[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_82 (Activation)      (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>           batch_normalization_82[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_79 (Conv2D)              (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">442368</span>      activation_78[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_80 (Conv2D)              (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">442368</span>      activation_78[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_83 (Conv2D)              (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">442368</span>      activation_82[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_84 (Conv2D)              (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">442368</span>      activation_82[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
average_pooling2d_8 (AveragePoo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           mixed8[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_77 (Conv2D)              (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">409600</span>      mixed8[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_79 (BatchNo (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1152</span>        conv2d_79[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_80 (BatchNo (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1152</span>        conv2d_80[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_83 (BatchNo (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1152</span>        conv2d_83[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_84 (BatchNo (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1152</span>        conv2d_84[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_85 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">245760</span>      average_pooling2d_8[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_77 (BatchNo (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">960</span>         conv2d_77[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_79 (Activation)      (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>           batch_normalization_79[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_80 (Activation)      (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>           batch_normalization_80[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_83 (Activation)      (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>           batch_normalization_83[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_84 (Activation)      (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>           batch_normalization_84[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_85 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_85[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_77 (Activation)      (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>           batch_normalization_77[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
mixed9_0 (Concatenate)          (None, None, None, <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">0</span>           activation_79[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_80[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, None, None, <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">0</span>           activation_83[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_84[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_85 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_85[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
mixed9 (Concatenate)            (None, None, None, <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0</span>           activation_77[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 mixed9_0[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 concatenate_1[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_85[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_90 (Conv2D)              (None, None, None, <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">917504</span>      mixed9[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_90 (BatchNo (None, None, None, <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">1344</span>        conv2d_90[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_90 (Activation)      (None, None, None, <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">0</span>           batch_normalization_90[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_87 (Conv2D)              (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">786432</span>      mixed9[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_91 (Conv2D)              (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1548288</span>     activation_90[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_87 (BatchNo (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1152</span>        conv2d_87[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_91 (BatchNo (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1152</span>        conv2d_91[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_87 (Activation)      (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>           batch_normalization_87[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_91 (Activation)      (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>           batch_normalization_91[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_88 (Conv2D)              (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">442368</span>      activation_87[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_89 (Conv2D)              (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">442368</span>      activation_87[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_92 (Conv2D)              (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">442368</span>      activation_91[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_93 (Conv2D)              (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">442368</span>      activation_91[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
average_pooling2d_9 (AveragePoo (None, None, None, <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0</span>           mixed9[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_86 (Conv2D)              (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">655360</span>      mixed9[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_88 (BatchNo (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1152</span>        conv2d_88[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_89 (BatchNo (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1152</span>        conv2d_89[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_92 (BatchNo (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1152</span>        conv2d_92[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_93 (BatchNo (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1152</span>        conv2d_93[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
conv2d_94 (Conv2D)              (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">393216</span>      average_pooling2d_9[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_86 (BatchNo (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">960</span>         conv2d_86[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_88 (Activation)      (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>           batch_normalization_88[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_89 (Activation)      (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>           batch_normalization_89[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_92 (Activation)      (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>           batch_normalization_92[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_93 (Activation)      (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>           batch_normalization_93[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
batch_normalization_94 (BatchNo (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">576</span>         conv2d_94[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_86 (Activation)      (None, None, None, <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span>           batch_normalization_86[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
mixed9_1 (Concatenate)          (None, None, None, <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">0</span>           activation_88[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_89[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, None, None, <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">0</span>           activation_92[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_93[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
activation_94 (Activation)      (None, None, None, <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>           batch_normalization_94[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
mixed10 (Concatenate)           (None, None, None, <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0</span>           activation_86[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 mixed9_1[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 concatenate_2[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
                                                                 activation_94[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, <span style="color:#ae81ff">2048</span>)         <span style="color:#ae81ff">0</span>           mixed10[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, <span style="color:#ae81ff">1024</span>)         <span style="color:#ae81ff">2098176</span>     global_average_pooling2d_1[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, <span style="color:#ae81ff">2</span>)            <span style="color:#ae81ff">2050</span>        dense_1[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
<span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span>
Total params: <span style="color:#ae81ff">23</span>,<span style="color:#ae81ff">903</span>,<span style="color:#ae81ff">010</span>
Trainable params: <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">100</span>,<span style="color:#ae81ff">226</span>
Non<span style="color:#f92672">-</span>trainable params: <span style="color:#ae81ff">21</span>,<span style="color:#ae81ff">802</span>,<span style="color:#ae81ff">784</span>
__________________________________________________________________________________________________
</code></pre></div><p>Phần train lại sẽ có khoảng hơn 2 triệu tham số, phần layter ở trước đó không train là khoảng 21 triệu tham số.</p>
<p>Đồ hình của model (các bạn có thể download về rồi zoom bự lên để xem rõ hơn).</p>
<p><img src="/post_image/inception_v2_model_311.png" alt="Hình ảnh kết quả nhận dạng chó mèo"></p>
<p>Chia tập dữ liệu ra thành 5 phần, 4 phần làm tập train, 1 phần làm tập validation.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">X, y, tags <span style="color:#f92672">=</span> dataset<span style="color:#f92672">.</span>dataset(data_directory, n)
nb_classes <span style="color:#f92672">=</span> len(tags)


sample_count <span style="color:#f92672">=</span> len(y)
train_size <span style="color:#f92672">=</span> sample_count <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">/</span><span style="color:#f92672">/</span> <span style="color:#ae81ff">5</span>
X_train <span style="color:#f92672">=</span> X[:train_size]
y_train <span style="color:#f92672">=</span> y[:train_size]
Y_train <span style="color:#f92672">=</span> np_utils<span style="color:#f92672">.</span>to_categorical(y_train, nb_classes)
X_test  <span style="color:#f92672">=</span> X[train_size:]
y_test  <span style="color:#f92672">=</span> y[train_size:]
Y_test <span style="color:#f92672">=</span> np_utils<span style="color:#f92672">.</span>to_categorical(y_test, nb_classes)
</code></pre></div><p>Để chống overfit, chúng ta sẽ thêm một số yếu tố như thực hiện các phép biến đổi affine trên ảnh gốc.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">datagen <span style="color:#f92672">=</span> ImageDataGenerator(
        featurewise_center<span style="color:#f92672">=</span>False,
        samplewise_center<span style="color:#f92672">=</span>False,
        featurewise_std_normalization<span style="color:#f92672">=</span>False,
        samplewise_std_normalization<span style="color:#f92672">=</span>False,
        zca_whitening<span style="color:#f92672">=</span>False,
        rotation_range<span style="color:#f92672">=</span><span style="color:#ae81ff">45</span>,
        width_shift_range<span style="color:#f92672">=</span><span style="color:#ae81ff">0.25</span>,
        height_shift_range<span style="color:#f92672">=</span><span style="color:#ae81ff">0.25</span>,
        horizontal_flip<span style="color:#f92672">=</span>True,
        vertical_flip<span style="color:#f92672">=</span>False,
        zoom_range<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>,
        channel_shift_range<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>,
        fill_mode<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">nearest</span><span style="color:#e6db74">&#39;</span>)
		
datagen<span style="color:#f92672">.</span>fit(X_train)
</code></pre></div><p>Cuối cùng, chúng ta sẽ xây dựng mô hình và tiến hành huấn luyện, lưu mô hình. Quá trình này tốn hơi nhiều thời gian.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
model <span style="color:#f92672">=</span> net<span style="color:#f92672">.</span>build_model(nb_classes)
model<span style="color:#f92672">.</span>compile(optimizer<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">rmsprop</span><span style="color:#e6db74">&#39;</span>, loss<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">categorical_crossentropy</span><span style="color:#e6db74">&#39;</span>, metrics<span style="color:#f92672">=</span>[<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">accuracy</span><span style="color:#e6db74">&#34;</span>])

<span style="color:#75715e"># train the model on the new data for a few epochs</span>

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">training the newly added dense layers</span><span style="color:#e6db74">&#34;</span>)

samples_per_epoch <span style="color:#f92672">=</span> X_train<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">/</span><span style="color:#f92672">/</span>batch_size<span style="color:#f92672">*</span>batch_size
steps_per_epoch <span style="color:#f92672">=</span> samples_per_epoch<span style="color:#f92672">/</span><span style="color:#f92672">/</span>batch_size
validation_steps <span style="color:#f92672">=</span> X_test<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">/</span><span style="color:#f92672">/</span>batch_size<span style="color:#f92672">*</span>batch_size

model<span style="color:#f92672">.</span>fit_generator(datagen<span style="color:#f92672">.</span>flow(X_train, Y_train, batch_size<span style="color:#f92672">=</span>batch_size, shuffle<span style="color:#f92672">=</span>True),
            samples_per_epoch<span style="color:#f92672">=</span>samples_per_epoch,
            epochs<span style="color:#f92672">=</span>nb_epoch,
            steps_per_epoch <span style="color:#f92672">=</span> steps_per_epoch,
            validation_data<span style="color:#f92672">=</span>datagen<span style="color:#f92672">.</span>flow(X_test, Y_test, batch_size<span style="color:#f92672">=</span>batch_size),
            validation_steps<span style="color:#f92672">=</span>validation_steps,
            )


net<span style="color:#f92672">.</span>save(model, tags, model_file_prefix)
</code></pre></div><p>Độ chính xác trên tập train.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Y_pred <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(X_test, batch_size<span style="color:#f92672">=</span>batch_size)
y_pred <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>argmax(Y_pred, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)

accuracy <span style="color:#f92672">=</span> float(np<span style="color:#f92672">.</span>sum(y_test<span style="color:#f92672">==</span>y_pred)) <span style="color:#f92672">/</span> len(y_test)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">accuracy: </span><span style="color:#e6db74">&#34;</span>, accuracy)

confusion <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>zeros((nb_classes, nb_classes), dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>int32)
<span style="color:#66d9ef">for</span> (predicted_index, actual_index, image) <span style="color:#f92672">in</span> zip(y_pred, y_test, X_test):
    confusion[predicted_index, actual_index] <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">rows are predicted classes, columns are actual classes</span><span style="color:#e6db74">&#34;</span>)
<span style="color:#66d9ef">for</span> predicted_index, predicted_tag <span style="color:#f92672">in</span> enumerate(tags):
    <span style="color:#66d9ef">print</span>(predicted_tag[:<span style="color:#ae81ff">7</span>], end<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>, flush<span style="color:#f92672">=</span>True)
    <span style="color:#66d9ef">for</span> actual_index, actual_tag <span style="color:#f92672">in</span> enumerate(tags):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> confusion[predicted_index, actual_index], end<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>)
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">&#34;</span>, flush<span style="color:#f92672">=</span>True)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">accuracy:  <span style="color:#ae81ff">0.9907213167661771</span>
rows are predicted classes, columns are actual classes
cat     <span style="color:#ae81ff">12238</span>   <span style="color:#ae81ff">106</span>
dog     <span style="color:#ae81ff">124</span>     <span style="color:#ae81ff">12320</span>
</code></pre></div><p>Kết quả đạt 0.99 trên tập train, khá tốt phải không các bạn.</p>
<p>Các bạn có thể download mô hình mình đã huấn luyện ở <a href="https://drive.google.com/open?id=1qQo8gj3KA6c1rPmJMVS_FZkVDcDmRgSf">https://drive.google.com/open?id=1qQo8gj3KA6c1rPmJMVS_FZkVDcDmRgSf</a>.</p>
<p>Thử show ra kết quả trên tập test xem như thế nào.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Y_pred <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(X_test, batch_size<span style="color:#f92672">=</span>batch_size)
y_pred <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>argmax(Y_pred, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)

lst_img <span style="color:#f92672">=</span> []

columns <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>
rows <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>
<span style="color:#75715e"># fig,= plt.figure(rows)</span>
<span style="color:#66d9ef">for</span> idx, val <span style="color:#f92672">in</span> enumerate(X_test):
    pred <span style="color:#f92672">=</span>y_pred[idx]
    label <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{}: {:.2f}</span><span style="color:#e6db74">%</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(tags[pred], Y_pred[idx][pred] <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>)
    image <span style="color:#f92672">=</span> dataset<span style="color:#f92672">.</span>reverse_preprocess_input(val)
    image <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>cvtColor(image,cv2<span style="color:#f92672">.</span>COLOR_BGR2RGB)
    cv2<span style="color:#f92672">.</span>putText(image,label , (<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">25</span>),  cv2<span style="color:#f92672">.</span>FONT_HERSHEY_SIMPLEX,<span style="color:#ae81ff">0.7</span>, (<span style="color:#ae81ff">255</span>, <span style="color:#ae81ff">000</span>, <span style="color:#ae81ff">0</span>), <span style="color:#ae81ff">2</span>)

    plt<span style="color:#f92672">.</span>subplot(rows,rows,idx<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
    plt<span style="color:#f92672">.</span>imshow(image)
    plt<span style="color:#f92672">.</span>title(label)
    plt<span style="color:#f92672">.</span>axis(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">off</span><span style="color:#e6db74">&#39;</span>)

plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="/post_image/nhan_dang_cho_meo1.png" alt="Hình ảnh kết quả nhận dạng chó mèo"></p>
<p>Kết quả có một số hình mèo bị nhận nhầm là chó, và một số hình không phải mèo, không phải chó. Nhìn chung kết quả cũng không đến nỗi nào quá tệ.</p>
<h2 id="quậy-phá-mô-hình">Quậy phá mô hình</h2>
<p>Mô hình InceptionV3 chúng ta đang xài có tổng cộng 311 lớp, chúng ta sẽ tiến hành một số pha quậy phá mô hình xem kết quả như trả ra như thế nào</p>
<h3 id="quậy-phá-1-mở-đóng-băng-một-số-lớp-cuối-và-train-trên-chúng">Quậy phá 1: Mở đóng băng một số lớp cuối và train trên chúng.</h3>
<p>Nếu các bạn để ý kỹ, trong đoạn mã nguồn của mình có đoạn</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># first: train only the top layers (which were randomly initialized)</span>
    <span style="color:#75715e"># i.e. freeze all convolutional InceptionV3 layers</span>
    <span style="color:#66d9ef">for</span> layer <span style="color:#f92672">in</span> base_model<span style="color:#f92672">.</span>layers:
        layer<span style="color:#f92672">.</span>trainable <span style="color:#f92672">=</span> False
</code></pre></div><p>Nghĩa là mình đóng băng toàn bộ 311 lớp, không cho nó train mà chỉ lấy kết quả của nó train lớp softmax cuối cùng. Bây giờ mình sẽ thử nghiệm với việc là để 299 lớp ban đầu vẫn đóng băng, và train lại toàn bộ các lớp còn lại (Các bạn đừng thắc mắc vì sao lại là 299 nha, do mình thích thôi).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">for</span> layer <span style="color:#f92672">in</span> model<span style="color:#f92672">.</span>layers[:<span style="color:#ae81ff">299</span>]:
    layer<span style="color:#f92672">.</span>trainable <span style="color:#f92672">=</span> False
<span style="color:#66d9ef">for</span> layer <span style="color:#f92672">in</span> model<span style="color:#f92672">.</span>layers[<span style="color:#ae81ff">299</span>:]:
    layer<span style="color:#f92672">.</span>trainable <span style="color:#f92672">=</span> True
</code></pre></div><p>Đồ hình của mô đồ khá giống ở trên, mình chỉ post lại kết quả của số param.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span><span style="color:#f92672">==</span>
Total params: <span style="color:#ae81ff">23</span>,<span style="color:#ae81ff">903</span>,<span style="color:#ae81ff">010</span>
Trainable params: <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">493</span>,<span style="color:#ae81ff">954</span>
Non<span style="color:#f92672">-</span>trainable params: <span style="color:#ae81ff">21</span>,<span style="color:#ae81ff">409</span>,<span style="color:#ae81ff">056</span>
__________________________________________________________________________________________________
</code></pre></div><p>Như vậy là có khoảng 2 triệu 5 tham số được huấn luyện lại</p>
<p>Model của mình huấn luyện được các bạn có thể download ở <a href="https://drive.google.com/open?id=1Ts18LICUAh6gcOnXcmuVr7PUG5IxpCdt">https://drive.google.com/open?id=1Ts18LICUAh6gcOnXcmuVr7PUG5IxpCdt</a>.</p>
<p>Kết quả đạt được:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">accuracy:  <span style="color:#ae81ff">0.9834610730133119</span>
rows are predicted classes, columns are actual classes
cat     <span style="color:#ae81ff">2429</span>    <span style="color:#ae81ff">69</span>
dog     <span style="color:#ae81ff">13</span>      <span style="color:#ae81ff">2447</span>
</code></pre></div><p><img src="/post_image/dog_cat_v1.png" alt="Hình ảnh kết quả nhận dạng chó mèo đóng băng 299 lớp đầu"></p>
<p>Kết quả 25 hình ngẫu nhiên cũng khá giống kết quả ở trước đó. Một số hình không có con vật bị nhận nhầm như hình còn mèo ở góc phải trên bị nhận nhầm là chó. Tuy nhiên, với chất lượng hình ảnh như thế này thì mình thấy kết quả như vậy là khá tuyệt vời.</p>
<h3 id="quậy-phá-2-chỉ-sử-dụng-72-lớp-đầu-tiên-của-inception">Quậy phá 2: Chỉ sử dụng 72 lớp đầu tiên của inception.</h3>
<p>Ở lần thí nghiệm này, mình sẽ chỉ sử dụng 72 lớp đầu tiên của inception để huấn luyện. Mình sẽ sửa lại một xíu ở hàm build model như sau:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x <span style="color:#f92672">=</span> base_model<span style="color:#f92672">.</span>layers[<span style="color:#ae81ff">72</span>]<span style="color:#f92672">.</span>output
</code></pre></div><p>Một lưu ý nhỏ là do inception không có tính tuần tự giữa các lớp (các bạn có thể nhìn hình ở trên sẽ thấy rõ), nên index sẽ không phải là 72 như thông thường.</p>
<p>Tiếp theo, chúng ta sẽ thực hiện việc huấn luyện lại mô hình và kết quả là:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">accuracy:  <span style="color:#ae81ff">0.5494150867285196</span>
rows are predicted classes, columns are actual classes
cat     <span style="color:#ae81ff">339</span>     <span style="color:#ae81ff">131</span>
dog     <span style="color:#ae81ff">2103</span>    <span style="color:#ae81ff">2385</span>
</code></pre></div><p>Kết quả khá tệ, lý do là mô hình các layer không theo sequence, mình lấy ngẫu nhiêu 72 lớp làm thông tin feature của các hình bị mất mát nhiều (ví dụ trường hợp layey 80 là tổng hợp thông tin của layter 79 + layter 4 + layer 48, mà mình chỉ lấy 72 layter đầu, nên sẽ mất đi phần đóng góp cực kỳ quan trọng của layter 4 và 48 ở lớp cao hơn).</p>
<p>Cảm ơn các bạn đã theo dõi. Hẹn gặp bạn ở các bài viết tiếp theo.</p>

  </div>
  
			</div>
  <footer class="col-md-10  mx-auto">
  <div >
  <div class="fb-like" data-share="true"  data-width="450"  data-show-faces="true">
</div> </p></div>
    <ul class="stats list-unstyled">
 
    
  <li class="tags">
    <ul class="list-inline">
       
            
            
                <i class="fa fa-tags"></i>
                
                
                <li class="list-inline-item"><a class="article-category-link" href="/tags/machine-learning">Machine learning</a></li>
                
                
                <li class="list-inline-item"><a class="article-category-link" href="/tags/deeplearning">Deeplearning</a></li>
                
                
                <li class="list-inline-item"><a class="article-category-link" href="/tags/dog-cat">dog cat</a></li>
                
            
        
    </ul>
  </li>
  
</ul>

	</div>
  </footer>
  <hr/>
<div class="titlerelate">Bài viết khác</div>
<div class="infinite-container featured-task">
<div class="card-deck card-break infinite-item">



    
        <div class="card">
		<a href="/blog/2018-10-08-mask-rnn/"
                class="button big previous">
		
		<img class="card-img-top lazy" src="../../post_image/maxresdefault.jpg" width="100" />
		<div class="card-body">
		<h5 class="card-title">
		Mask R-CNN trong bài toán nhận dạng và phân vùng đối tượng
				</h5>
				</div>
				</a>
				</div>
    

    
        <div class="card">
		<a href="/blog/2018-11-01-overview-of-gradient-descent-optimization-algorithm/"
                class="button big previous">
		
		<img class="card-img-top lazy" src="../../post_image/GradientDescentWithMutlipleLocalMinimum.jpg" width="100" />
		
		<div class="card-body">
		<h5 class="card-title">
		Overview of gradient descent optimization algorithm
				</h5>
				</div>
				</a>
				</div>
    

</div>
</div>



<div class="fb-comments" data-href="" data-width="" data-numposts="5"></div>

    <article class="post">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "phamduytung" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </article>



</article>


		
    </main>
    
	</div>
	</div>
    
	<hr>
  <footer class="footer">
  <div class="container text-center">
    
    <p class="copyright">
      
        &copy; 2020
        
          Phạm Duy Tùng Machine Learning Blog
        
      
     
    </p>
	</div>
  </footer>
    
    

    
      
    

    
      
      
      
        <script src="//cdn.bootcss.com/highlight.js/9.15.8/highlight.min.js"></script>
        
        
        
        <script src="//cdn.bootcss.com/highlight.js/9.15.8/languages/python.min.js"></script>
        <script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>
      
    
    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/skel/3.0.1/skel.min.js"></script>
     

   <script src="/js/jquery-3.3.1.min.js"></script>
   
    <script src="/js/bootstrap.min.js"></script>
      <script src="/js/util.js"></script>
      <script src="/js/main.js"></script>
     
    

    
      
        
      
    
	
    
    <script>hljs.initHighlightingOnLoad();</script>
      
<script async
src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


	  
	  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-114911596-1"  data-cfasync="false"></script>
<script  data-cfasync="false">
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-114911596-1');
</script>
<script src="https://cdn.jsdelivr.net/npm/intersection-observer@0.5.1/intersection-observer.js"  data-cfasync="false"></script>
<script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@12.0.0/dist/lazyload.min.js"  data-cfasync="false"></script>
	   <script  type="text/javascript"  data-cfasync="false">

  function getcontent(){
 

   

             var myLazyLoad = new LazyLoad({
    elements_selector: ".lazy"
});
                }
            
			
			$(document).ready(function(){
			getcontent();
			}); 
</script>

  </body>
</html>

