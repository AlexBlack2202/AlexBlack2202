<!DOCTYPE HTML>

<html>
    <head>
        <script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "\/"
        },
        "articleSection" : "blog",
        "name" : "Hệ thống gợi ý khoá học cho website DonorChoose.org",
        "headline" : "Hệ thống gợi ý khoá học cho website DonorChoose.org",
        "description" : "Ở bài viết này, chúng ta tìm hiểu một số mẹo khi huấn luyện mô hình sử dụng deep learning.",
        "inLanguage" : "en",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2018",
        "datePublished": "2018-12-11 00:19:00 \x2b0300 \x2b0300",
        "dateModified" : "2018-12-11 00:19:00 \x2b0300 \x2b0300",
        "url" : "\/blog\/2019-01-03-donor-project-matching-with-recommender-systems\/",
        "wordCount" : "3756",
        "keywords" : [ "Machine learning","Deeplearning","recommender system","Blog" ]
    }
    </script>
        
            
                <title>Hệ thống gợi ý khoá học cho website DonorChoose.org</title>
            
        

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        
		<meta name="generator" content="Phạm Duy Tùng" />
        
  
    
  

  

  
  
  
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content='/favicon/mstile.png'>
  <meta name="application-name" content="Phạm Duy Tùng Machine Learning Blog">
  <meta name="msapplication-tooltip" content="Blog ML của Phạm Duy Tùng và Đặng Thị Hằng">
   
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">



        
            <meta name="author" content="Phạm Duy Tùng">
        
        
            <meta name="description" content="Ở bài viết này, chúng ta tìm hiểu một số mẹo khi huấn luyện mô hình sử dụng deep learning.">
        

        <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Hệ thống gợi ý khoá học cho website DonorChoose.org"/>
<meta name="twitter:description" content="Ở bài viết này, chúng ta tìm hiểu một số mẹo khi huấn luyện mô hình sử dụng deep learning."/>
<meta name="twitter:site" content="@example"/>

        <meta property="og:title" content="Hệ thống gợi ý khoá học cho website DonorChoose.org" />
<meta property="og:description" content="Ở bài viết này, chúng ta tìm hiểu một số mẹo khi huấn luyện mô hình sử dụng deep learning." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/2019-01-03-donor-project-matching-with-recommender-systems/" />
<meta property="article:published_time" content="2018-12-11T00:19:00+03:00" />
<meta property="article:modified_time" content="2018-12-11T00:19:00+03:00" />

        <meta property="og:image" content="//images/logo.png">
        <meta property="og:image:type" content="image/png">
        <meta property="og:image:width" content="512">
        <meta property="og:image:height" content="512">
        <meta itemprop="name" content="Hệ thống gợi ý khoá học cho website DonorChoose.org">
<meta itemprop="description" content="Ở bài viết này, chúng ta tìm hiểu một số mẹo khi huấn luyện mô hình sử dụng deep learning.">
<meta itemprop="datePublished" content="2018-12-11T00:19:00&#43;03:00" />
<meta itemprop="dateModified" content="2018-12-11T00:19:00&#43;03:00" />
<meta itemprop="wordCount" content="3756">



<meta itemprop="keywords" content="Machine learning,Deeplearning,recommender system," />
        

        
            
        

        
        
          
			
			 <link rel="stylesheet" href="/css/font-awesome.min.css">
			 <link rel="stylesheet" href="/css/bootstrap.min.css">


          
            <link rel="stylesheet" href="/css/academicons.min.css">
        

        
            
                
            
        


  
    
    <link href='//cdn.bootcss.com/highlight.js/9.15.8/styles/github.min.css' rel='stylesheet' type='text/css' />
  


      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-114911596-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

	  
	  <style>
	  
	  body{
font-family: Helvetica,Arial,sans-serif;
}

.card{
	margin-bottom: 10px;
}

#disqus_thread{
padding: 0 5px;
}

.item-header{
padding: 0;
}

.single-content-img{
width: 100%;
    max-height: 450px !important;
    background-size: cover;
    display: block;
    background-position: center;
}

.thumbnail {
    position: relative;
}

.caption {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
	background: rgba(0, 0, 0, 0.25);
	text-align:left;
}

.caption .title{
	font-size: 1.6em;
    line-height: 1.4em;
    top: 0;
	margin-left:20px;
	margin-top:20px;
	
}

.caption .title-caption{
margin-left:10px;
}

#content p{
text-align: justify;
    line-height: 1.9;
    font-size: 12pt;
}

#content img{
	display: block;
    margin-left: auto;
margin-right: auto;
max-width:98%;
}

img + strong {
    font-style: normal;
    display: inherit;
    text-align: center;
}
.img-news{
max-height:150px;
width:100%;
}

.news-tittle{
	padding-top:15px;
	text-align:justify;
}

.author{
	color: orange;
}
.author-inline{
	color: orange;
}

.adv{
height:18px;
}

h1, h2, h3, h4{
padding-bottom: 10px;
    font-weight: bold;
}

h1{
color: #d04764}


h2{
color: orange}

h3{
color: #d04764}

h4{
color: #8dec89}

.hljs{
    white-space: pre-wrap;
    white-space: -moz-pre-wrap;
    white-space: -pre-wrap;
    white-space: -o-pre-wrap;
    word-wrap: break-word;}
	  .titledetail {
    display: block;
    overflow: hidden;
    line-height: 53px;
    font-size: 45px;
    color: #333;
    font-family: 'Roboto Condensed',sans-serif;
    font-weight: 600;
    margin: auto;
	padding:25px 0;
	text-align:justify;
}

.newsrelate {
    display: block;
    overflow: hidden;
	 list-style:none;
}
a ,a:hover{
    text-decoration: none;
}
.newsrelate li {
    float: left;
    overflow: hidden;
    width: 30%;
    margin-left: 2.5%;
    margin-bottom: 15px;
}

.newsrelate li a {
    display: block;
    overflow: hidden;
}

.newsrelate li h3 {
    display: block;
    overflow: hidden;
    line-height: 1.3em;
    font-size: 16pt;
    color: #333;
    line-height: 22px;
    font-weight: 300;
    font-family: Arial,Helvetica,sans-serif;
    width: auto;
    margin: 5px auto;
}

.titlerelate {
    overflow: hidden;
    font-size: 18px;
    font-weight: 600;
    color: #333;
    font-family: 'Roboto Condensed',sans-serif;
    line-height: 32px;
    text-transform: uppercase;
}


	  </style>
	  
    </head>
    <body>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '1546237302193677',
      xfbml      : true,
      version    : 'v5.0'
    });
    FB.AppEvents.logPageView();
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "https://connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>
<div id="fb-root"></div>
<script async defer crossorigin="anonymous" src="https://connect.facebook.net/vi_VN/sdk.js#xfbml=1&version=v5.0&appId=1853483258232756&autoLogAppEvents=1"></script>
      
      

    
    
<header id="header"  style="background: #790014; color: hsla(0,0%,100%,1);">
<div class="container">
    <nav class="navbar navbar-expand-md navbar-dark">
	
	<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav mr-auto">
            
                <li class="nav-item">
                    <a class='nav-link' href="/blog">
                            <i class="fa fa-home active">&nbsp;</i>Home
                    </a>
                </li>
            
                <li class="nav-item">
                    <a class='nav-link' href="/news/">
                            <i class="fa fa-list">&nbsp;</i>News
                    </a>
                </li>
            
                <li class="nav-item">
                    <a class='nav-link' href="/xem-truyen/">
                            <i class="fa fa-id-card-o">&nbsp;</i>Truyện
                    </a>
                </li>
            
        </ul>
    </nav>
    </div></div>
</header>


   
    
	<div class="container">
	<div class="adv"></div>
	<div>
    <main role="main" >
	
        
        
        <article class="col-md-10 col-lg-9 mx-auto">
  


        
		 <div class="">
            <h3 class="titledetail">Hệ thống gợi ý khoá học cho website DonorChoose.org</h3>
			
			<div class="col-md-12">
			 
			  <time class="published"
            datetime='2018-12-11'>
            11/12/2018</time>
		 - 
			   <span class="author">Phạm Duy Tùng</span>
			   
			
		<div class="thumbnail text-center">
		 <img class="img-fluid single-content-img lazy" src="/post_image/Donors-can-follow-these-general-steps-to-secure-matching-gift-donations.jpg" />
		
			</div>
			 
            
        
       



  

  

  <div id="content" class="col-md-10 mx-auto">
    <h2 id="đặt-vấn-đề">Đặt vấn đề</h2>
<p>DonorsChoose.org được thành lập vào năm 2000 bởi một giáo viên lịch sử tại Mỹ tên là Bronx và đã huy động được 685 triệu đô la cho các lớp học. 3/4 các giáo viên ở các trường công lập ở Hoa Kỳ đã sử dụng Donor để gửi các yêu cầu bài tập cho học sinh. Từ đó, Donor trở thành nền tảng giáo dục hàng đầu hỗ trợ cho các vấn đề giáo dục công cộng.</p>
<p>Đến nay, hơn 3 triệu người dùng và đối tác đã đóng góp hơn 1,1 triệu dự án cho Donor. Nhưng các giáo viên vẫn phải tốn hàng tỷ đô tiền túi để chuẩn bị các dụng cụ học tập trên lớp (để truyền tải kiến thức cho học sinh).</p>
<p>Giải pháp được đưa ra ở đây là xây dựng một chiến dịch gợi ý cho các nhà tại trợ.</p>
<h3 id="phân-tích-dữ-liệu">Phân tích dữ liệu</h3>
<p>Chúng ta có các file sau:</p>
<p>File Donations.csv.  Với mỗi dự án (Project ID), sẽ có 1 hoặc nhiều nhà quyên góp (Donor ID) mỗi cặp (dự án - nhà quyên góp sẽ định dang bằng 1 mã chung (Donation ID) và có các cột thông tin liên quan đến việc quyên góp đó). File có xấp xỉ 4.67 triệu dòng (chính xác là 4687844 dòng) và 7 cột. (Project ID - Định danh dự án, Donation ID - Định danh khoảng đóng góp (tưởng tượng như khoá tự tăng của bảng này đó các bạn), Donor ID - Mã định danh người đóng góp, Donation Included Option - hỗ trợ website donoschoose 15% giá trị quyên góp, Donation Amount - Số tiền quyên góp, Donor Cart Sequence - Thứ tự của dự án trọng bảng danh sách quyên góp,Donation Received Date - Ngày giờ quyên góp).</p>
<p>File Donors.csv. File định danh người quyên góp. Chứa tổng cộng hơn 2 triệu dòng( chính xác là 2122640 dòng) 
File có kích thước 2122640 x 5 với các thông tin cột là Donor ID (khoá chính, không trùng), Donor City (tên thành phố nhà đầu tư đang sinh sống), Donor State (tiểu bang mà người quyên góp đang sống), Donor is teacher, Donor Zip (3 ký tự đầu của mã bưu điện nhà từ thiện).</p>
<p>File Teacher.csv. File có tổng cộng 402900 dòng với các cột TeachId, Teacher Prefix (Mr, Mrs, Ms), Teacher First Project Posted Date.</p>
<p>File Schools.csv. File có tổng cộng 72994 dòng với các cột là SchoolID, SchoolName (tên trường có thể trùng nhau), School Metro Type ( phân loại trường thuộc 1 trong 5 nhóm : suburnban - ngoại ô, rural - nông thôn, uban - thành thị, town - thị trấn, unknow), School Percentage Free Lunch ( Số nguyên, mô tả tỷ lệ phần trăm số học sinh đủ điều kiện ăn trưa miễn phí hoặc ăn trưa giảm phí. Dữ liệu thu được cung cấp bởi một đối tác thống kê độc lập là NCES. Nếu trường nào không có giá trị do NCES cung cấp, chúng ta sẽ lấy số phần trăm này là trung bình phần trăm của các trường cùng huyện), School State (Trường đang toạ lạc ở bang nào (vd cali, Florida, Virginia, &hellip;)), School Zip (mã bưu chính), School City, School County</p>
<p>File Resources.csv. Với mỗi dự án, chúng ta cần các loại tài nguyên khác nhau. Các cột là Project ID (mã dự án), Resource Item Name (tên tài nguyên cần cho dự án đó vd project 000009891526c0ade7180f8423792063 cần &lsquo;chair move and store cart&rsquo;), Resource Quantity (số lượng tài nguyên cần, vd cần 1 cái ghế, 2 cái bảng v.v), 
Resource Unit Price (đơn giá cho 1 đơn vị tài nguyên, vd cái ghế giá 7 ngàn, cái bảng giá 10 ngàn, nếu 1 unit là ghế + bảng thì là 17 ngàn), Resource Vendor Name(nhà cung cấp, vd: Amazon Business, Woodwind and Brasswind).</p>
<p>File Projects.csv</p>
<h3 id="xây-dựng-chiến-lược-tiếp-cận-bài-toán">Xây dựng chiến lược tiếp cận bài toán</h3>
<p>Hãy xem đây như là bài toán gợi ý. Và Donors chính là hệ thống cung cấp các sản phẩm. Ví dụ đơn giản là bạn có website nghe nhạc mp3.zing.vn, alice vào nghe một hoặc một vài bài nhạc. Chúng ta sẽ xây dựng một hệ gợi ý những bài nhạc tiếp theo alice nên nghe dựa vào những bài nhạc đã nghe trước đó của alice. Tương tự vậy, hệ thống Donor như là website mp3.zing, bài nhạc tương tự như các project đang có, người dùng tương tự như các nhà tự thiện. Một khi một nhà từ thiện đã quyên góp cho 1 hoặc 1 nhón các dự án, chúng ta sẽ lên kế hoạch và gợi ý cho khác hàng dự án tiếp theo khách hàng nên tìm hiểu kỹ để xét xem có nên donate hay không.</p>
<p>Dựa vào các chiến lược trên, chúng ta có 3 cách có thể tiếp cận vấn đề:</p>
<ul>
<li>Content-based filltering.</li>
<li>Collaborative Filtering</li>
<li>Hybrid methods</li>
</ul>
<h4 id="1-tiền-xử-lý-dữ-liệu">1. Tiền xử lý dữ liệu</h4>
<p>Trước khi bắt đầu xây dựng chương trình gợi ý, chúng ta cần phải load dữ liệu lên bộ nhớ chính và làm sạch dữ liệu.</p>
<p>Trước tiên, chúng ta sẽ import các thư viện cần thiết. Nếu thiếu các thư viện nào, các bạn cứ pip install tên thư viện trong cmd/terminal là được</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> scipy
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> math
<span style="color:#f92672">import</span> random
<span style="color:#f92672">import</span> sklearn
<span style="color:#f92672">from</span> nltk.corpus <span style="color:#f92672">import</span> stopwords
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
<span style="color:#f92672">from</span> sklearn.feature_extraction.text <span style="color:#f92672">import</span> TfidfVectorizer
<span style="color:#f92672">from</span> sklearn.metrics.pairwise <span style="color:#f92672">import</span> cosine_similarity
<span style="color:#f92672">from</span> scipy.sparse.linalg <span style="color:#f92672">import</span> svds
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> os
</code></pre></div><p>Tiếp theo, chúng ta sẽ load 3 file Projects.csv, Donations.csv, Donors.csv lên và merge donations với donors.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Set up test mode to save some time</span>
test_mode <span style="color:#f92672">=</span> True

<span style="color:#75715e"># Read datasets</span>
projects <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">../input/Projects.csv</span><span style="color:#e6db74">&#39;</span>)
donations <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">../input/Donations.csv</span><span style="color:#e6db74">&#39;</span>)
donors <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">../input/Donors.csv</span><span style="color:#e6db74">&#39;</span>)

<span style="color:#75715e">#this piece of code converts Project_ID which is a 32-bit Hex int digits 10-1010</span>
<span style="color:#75715e"># create column &#34;project_id&#34; with sequential integers</span>
f<span style="color:#f92672">=</span>len(projects)
projects[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">project_id</span><span style="color:#e6db74">&#39;</span>] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nan
g <span style="color:#f92672">=</span> list(range(<span style="color:#ae81ff">10</span>,f<span style="color:#f92672">+</span><span style="color:#ae81ff">10</span>))
g <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series(g)
projects[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">project_id</span><span style="color:#e6db74">&#39;</span>] <span style="color:#f92672">=</span> g<span style="color:#f92672">.</span>values

<span style="color:#75715e"># Merge datasets</span>
donations <span style="color:#f92672">=</span> donations<span style="color:#f92672">.</span>merge(donors, on<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Donor ID</span><span style="color:#e6db74">&#34;</span>, how<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">left</span><span style="color:#e6db74">&#34;</span>)
df <span style="color:#f92672">=</span> donations<span style="color:#f92672">.</span>merge(projects,on<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#34;</span>, how<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">left</span><span style="color:#e6db74">&#34;</span>)

<span style="color:#75715e"># only load a few lines in test mode</span>
<span style="color:#66d9ef">if</span> test_mode:
    df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">10000</span>)

donations_df <span style="color:#f92672">=</span> df
</code></pre></div><p>Ở giai đoạn xây dựng code và debug, mình chỉ load 10000 dữ liệu lên để test thử  (để đảm bảo rằng mình code đúng - bằng cách set test_mode = True). Khi chạy thật mình sẽ set lại test_mode = False.</p>
<p>Thực hiện một vài bước phân tích kỹ thuật đơn giản để nắm rõ hơn về dữ liệu.</p>
<p>Thử đo mối quan hệ giữa các dự án và các &ldquo;mạnh thường quân&rdquo;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Deal with missing values</span>
donations[<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Donation Amount</span><span style="color:#e6db74">&#34;</span>] <span style="color:#f92672">=</span> donations[<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Donation Amount</span><span style="color:#e6db74">&#34;</span>]<span style="color:#f92672">.</span>fillna(<span style="color:#ae81ff">0</span>)

<span style="color:#75715e"># Define event strength as the donated amount to a certain project</span>
donations_df[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">eventStrength</span><span style="color:#e6db74">&#39;</span>] <span style="color:#f92672">=</span> donations_df[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Donation Amount</span><span style="color:#e6db74">&#39;</span>]

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">smooth_donor_preference</span>(x):
    <span style="color:#66d9ef">return</span> math<span style="color:#f92672">.</span>log(<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>x, <span style="color:#ae81ff">2</span>)
    
donations_full_df <span style="color:#f92672">=</span> donations_df \
                    <span style="color:#f92672">.</span>groupby([<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Donor ID</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#39;</span>])[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">eventStrength</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>sum() \
                    <span style="color:#f92672">.</span>apply(smooth_donor_preference)<span style="color:#f92672">.</span>reset_index()
        
<span style="color:#75715e"># Update projects dataset</span>
project_cols <span style="color:#f92672">=</span> projects<span style="color:#f92672">.</span>columns
projects <span style="color:#f92672">=</span> df[project_cols]<span style="color:#f92672">.</span>drop_duplicates()

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74"># of projects: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> len(projects))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74"># of unique user/project donations: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> len(donations_full_df))
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># of projects: 1889</span>
<span style="color:#75715e"># of unique user/project donations: 8648</span>
</code></pre></div><p>Dựa vào kết quả trên tập test, chúng ta có thể đưa ra một vài nhận xét như sau:</p>
<ul>
<li>Hầu hết các mạnh thường quân chỉ donate cho 1 project (tỷ lệ 86,48%)</li>
<li>Sẽ có trường hợp 1 mạnh thường quân sẽ donate cho nhiều dự án, và cũng có trường hợp 1 mạnh thường quân donate nhiều lần cho 1 dự án. Trường hợp này chiếm phần ít.</li>
</ul>
<p>Để đánh giá mô hình, chúng ta sẽ chia tập dữ liệu thành 2 phần là train và test. Ở đây, chúng ta sẽ set tỷ lệ train/test là 20%.</p>
<h4 id="2-xây-dựng-mô-hình-content-based-filtering">2. Xây dựng mô hình Content-Based Filtering</h4>
<p>Cách tiếp cận đầu tiên, chúng ta sẽ tìm những project gần giống với những project mà donor đã donated. Đơn giản nhất là với mỗi project, chúng ta sẽ định nghĩa các vector đặc trưng của chúng và đo độ giống nhau giữa hai vector đó. Vector đặc trưng chúng ta có thể xây dựng trên các thuộc tính như project type, project catefory, grade level, resource category, cost, school zip code, &hellip; hoặc các bạn có thể từ các vector cơ bản do tập dữ liệu cung cấp bổ sung thêm các vector cấp cao hơn, ví dụ như là rút trích các feature từ tên project hoặc mô tả của project, loại bỏ stopwords &hellip;</p>
<p>Ở đây, chúng ta sẽ sử dụng kỹ thuật TF-IDF để rút trích thông tin đặc trưng của dự án dựa trên project tittle và description. Về TF-IDF, các bạn có thể đọc ở một bài viết nào đó của google, mình không tiện nhắc đến nó chi tiết ở bài viết này.</p>
<h5 id="a-xây-dựng-tập-đặc-trưng">a. Xây dựng tập đặc trưng</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#75715e"># Preprocessing of text data</span>
textfeats <span style="color:#f92672">=</span> [<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Project Title</span><span style="color:#e6db74">&#34;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Project Essay</span><span style="color:#e6db74">&#34;</span>]
<span style="color:#66d9ef">for</span> cols <span style="color:#f92672">in</span> textfeats:
    projects[cols] <span style="color:#f92672">=</span> projects[cols]<span style="color:#f92672">.</span>astype(str) 
    projects[cols] <span style="color:#f92672">=</span> projects[cols]<span style="color:#f92672">.</span>astype(str)<span style="color:#f92672">.</span>fillna(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>) <span style="color:#75715e"># FILL NA</span>
    projects[cols] <span style="color:#f92672">=</span> projects[cols]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>lower() <span style="color:#75715e"># Lowercase all text, so that capitalized words dont get treated differently</span>
 
text <span style="color:#f92672">=</span> projects[<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Project Title</span><span style="color:#e6db74">&#34;</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> </span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">+</span> projects[<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Project Essay</span><span style="color:#e6db74">&#34;</span>]
vectorizer <span style="color:#f92672">=</span> TfidfVectorizer(strip_accents<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">unicode</span><span style="color:#e6db74">&#39;</span>,
                             analyzer<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">word</span><span style="color:#e6db74">&#39;</span>,
                             lowercase<span style="color:#f92672">=</span>True, <span style="color:#75715e"># Convert all uppercase to lowercase</span>
                             stop_words<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">english</span><span style="color:#e6db74">&#39;</span>, <span style="color:#75715e"># Remove commonly found english words (&#39;it&#39;, &#39;a&#39;, &#39;the&#39;) which do not typically contain much signal</span>
                             max_df <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.9</span>, <span style="color:#75715e"># Only consider words that appear in fewer than max_df percent of all documents</span>
                             <span style="color:#75715e"># max_features=5000 # Maximum features to be extracted                    </span>
                            )                        
project_ids <span style="color:#f92672">=</span> projects[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>tolist()
tfidf_matrix <span style="color:#f92672">=</span> vectorizer<span style="color:#f92672">.</span>fit_transform(text)
tfidf_feature_names <span style="color:#f92672">=</span> vectorizer<span style="color:#f92672">.</span>get_feature_names()


<span style="color:#75715e">## build profile</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_project_profile</span>(project_id):
    idx <span style="color:#f92672">=</span> project_ids<span style="color:#f92672">.</span>index(project_id)
    project_profile <span style="color:#f92672">=</span> tfidf_matrix[idx:idx<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]
    <span style="color:#66d9ef">return</span> project_profile

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_project_profiles</span>(ids):
    project_profiles_list <span style="color:#f92672">=</span> [get_project_profile(x) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> np<span style="color:#f92672">.</span>ravel([ids])]
    project_profiles <span style="color:#f92672">=</span> scipy<span style="color:#f92672">.</span>sparse<span style="color:#f92672">.</span>vstack(project_profiles_list)
    <span style="color:#66d9ef">return</span> project_profiles

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">build_donors_profile</span>(donor_id, donations_indexed_df):
    donations_donor_df <span style="color:#f92672">=</span> donations_indexed_df<span style="color:#f92672">.</span>loc[donor_id]
    donor_project_profiles <span style="color:#f92672">=</span> get_project_profiles(donations_donor_df[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#39;</span>])
    donor_project_strengths <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(donations_donor_df[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">eventStrength</span><span style="color:#e6db74">&#39;</span>])<span style="color:#f92672">.</span>reshape(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>)
    <span style="color:#75715e">#Weighted average of project profiles by the donations strength</span>
    donor_project_strengths_weighted_avg <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sum(donor_project_profiles<span style="color:#f92672">.</span>multiply(donor_project_strengths), axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>) <span style="color:#f92672">/</span> (np<span style="color:#f92672">.</span>sum(donor_project_strengths)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
    donor_profile_norm <span style="color:#f92672">=</span> sklearn<span style="color:#f92672">.</span>preprocessing<span style="color:#f92672">.</span>normalize(donor_project_strengths_weighted_avg)
    <span style="color:#66d9ef">return</span> donor_profile_norm

<span style="color:#f92672">from</span> tqdm <span style="color:#f92672">import</span> tqdm

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">build_donors_profiles</span>(): 
    donations_indexed_df <span style="color:#f92672">=</span> donations_full_df[donations_full_df[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>isin(projects[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#39;</span>])]<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Donor ID</span><span style="color:#e6db74">&#39;</span>)
    donor_profiles <span style="color:#f92672">=</span> {}
    <span style="color:#66d9ef">for</span> donor_id <span style="color:#f92672">in</span> tqdm(donations_indexed_df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>unique()):
        donor_profiles[donor_id] <span style="color:#f92672">=</span> build_donors_profile(donor_id, donations_indexed_df)
    <span style="color:#66d9ef">return</span> donor_profiles

donor_profiles <span style="color:#f92672">=</span> build_donors_profiles()
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74"># of donors with profiles: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> len(donor_profiles))

mydonor1 <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">6d5b22d39e68c656071a842732c63a0c</span><span style="color:#e6db74">&#34;</span>
mydonor2 <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">0016b23800f7ea46424b3254f016007a</span><span style="color:#e6db74">&#34;</span>
mydonor1_profile <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(sorted(zip(tfidf_feature_names, 
                        donor_profiles[mydonor1]<span style="color:#f92672">.</span>flatten()<span style="color:#f92672">.</span>tolist()), 
                        key<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> x: <span style="color:#f92672">-</span>x[<span style="color:#ae81ff">1</span>])[:<span style="color:#ae81ff">10</span>],
                        columns<span style="color:#f92672">=</span>[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">token</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">relevance</span><span style="color:#e6db74">&#39;</span>])
mydonor2_profile <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(sorted(zip(tfidf_feature_names, 
                        donor_profiles[mydonor2]<span style="color:#f92672">.</span>flatten()<span style="color:#f92672">.</span>tolist()), 
                        key<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> x: <span style="color:#f92672">-</span>x[<span style="color:#ae81ff">1</span>])[:<span style="color:#ae81ff">10</span>],
                        columns<span style="color:#f92672">=</span>[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">token</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">relevance</span><span style="color:#e6db74">&#39;</span>])

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">feature of user </span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">+</span> str(mydonor1))
<span style="color:#66d9ef">print</span>(mydonor1_profile)

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">feature of user </span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">+</span> str(mydonor2))
<span style="color:#66d9ef">print</span>(mydonor2_profile)

</code></pre></div><p>Mã nguồn ở trên cũng có chú thích đầy đủ, và đọc cũng dễ hiểu, nên mình không nói thêm gì nhiều. Mình tóm gọn một chút là chúng ta sẽ convert toàn bộ project tittle và description về dạng chữ thường, tách từ dựa vào khoảng trắng, loại bỏ những english stopwords. Sau đó xây dựng profile cho từng donor.</p>
<p>Kết quả</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">feature of  user <span style="color:#ae81ff">6</span>d5b22d39e68c656071a842732c63a0c
        token  relevance
<span style="color:#ae81ff">0</span>       music   <span style="color:#ae81ff">0.450057</span>
<span style="color:#ae81ff">1</span>  auditorium   <span style="color:#ae81ff">0.355256</span>
<span style="color:#ae81ff">2</span>        cart   <span style="color:#ae81ff">0.272809</span>
<span style="color:#ae81ff">3</span>       chair   <span style="color:#ae81ff">0.223861</span>
<span style="color:#ae81ff">4</span>   equipment   <span style="color:#ae81ff">0.211338</span>
<span style="color:#ae81ff">5</span>   musicians   <span style="color:#ae81ff">0.179244</span>
<span style="color:#ae81ff">6</span>        time   <span style="color:#ae81ff">0.172908</span>
<span style="color:#ae81ff">7</span>      moving   <span style="color:#ae81ff">0.137749</span>
<span style="color:#ae81ff">8</span>        ohms   <span style="color:#ae81ff">0.134065</span>
<span style="color:#ae81ff">9</span>     prepare   <span style="color:#ae81ff">0.131274</span>
feature of  user <span style="color:#ae81ff">0016</span>b23800f7ea46424b3254f016007a
         token  relevance
<span style="color:#ae81ff">0</span>  pollinators   <span style="color:#ae81ff">0.670222</span>
<span style="color:#ae81ff">1</span>       plants   <span style="color:#ae81ff">0.305398</span>
<span style="color:#ae81ff">2</span>       module   <span style="color:#ae81ff">0.223407</span>
<span style="color:#ae81ff">3</span>  pollination   <span style="color:#ae81ff">0.211870</span>
<span style="color:#ae81ff">4</span>        seeds   <span style="color:#ae81ff">0.180609</span>
<span style="color:#ae81ff">5</span>      writing   <span style="color:#ae81ff">0.166816</span>
<span style="color:#ae81ff">6</span>        books   <span style="color:#ae81ff">0.137455</span>
<span style="color:#ae81ff">7</span>      reading   <span style="color:#ae81ff">0.115003</span>
<span style="color:#ae81ff">8</span>       weaved   <span style="color:#ae81ff">0.111704</span>
<span style="color:#ae81ff">9</span>         bees   <span style="color:#ae81ff">0.101842</span>
</code></pre></div><p>Nhìn kết quả trên, ta thấy rằng donor 1 có vẻ thích những thứ liên quan đến âm nhạc (music, auditorim), trong khi đó donor 2 thích những thứ liên quan đến trồng trọt (pollinators - thụ phấn, plants - cây cối)</p>
<h5 id="b-xây-dựng-mô-hình">b. Xây dựng mô hình</h5>
<p>Việc xây dựng mô hình đến đây là khá đơn giản. Chúng ta chỉ việc tính khoảng cách cosin giữa vector cần dự đoán và toàn bộ vector có trong tập train rồi show top K prject có liên quan cao nhất</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ContentBasedRecommender</span>:
    
    MODEL_NAME <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Content-Based</span><span style="color:#e6db74">&#39;</span>
    
    <span style="color:#66d9ef">def</span> __init__(self, projects_df<span style="color:#f92672">=</span>None):
        self<span style="color:#f92672">.</span>project_ids <span style="color:#f92672">=</span> project_ids
        self<span style="color:#f92672">.</span>projects_df <span style="color:#f92672">=</span> projects_df
        
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_model_name</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>MODEL_NAME
        
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_get_similar_projects_to_donor_profile</span>(self, donor_id, topn<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>):
        <span style="color:#75715e">#Computes the cosine similarity between the donor profile and all project profiles</span>
        cosine_similarities <span style="color:#f92672">=</span> cosine_similarity(donor_profiles[donor_id], tfidf_matrix)
        <span style="color:#75715e">#Gets the top similar projects</span>
        similar_indices <span style="color:#f92672">=</span> cosine_similarities<span style="color:#f92672">.</span>argsort()<span style="color:#f92672">.</span>flatten()[<span style="color:#f92672">-</span>topn:]
        <span style="color:#75715e">#Sort the similar projects by similarity</span>
        similar_projects <span style="color:#f92672">=</span> sorted([(project_ids[i], cosine_similarities[<span style="color:#ae81ff">0</span>,i]) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> similar_indices], key<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> x: <span style="color:#f92672">-</span>x[<span style="color:#ae81ff">1</span>])
        <span style="color:#66d9ef">return</span> similar_projects
        
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">recommend_projects</span>(self, donor_id, projects_to_ignore<span style="color:#f92672">=</span>[], topn<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, verbose<span style="color:#f92672">=</span>False):
        similar_projects <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_get_similar_projects_to_donor_profile(donor_id)
        <span style="color:#75715e">#Ignores projects the donor has already donated</span>
        similar_projects_filtered <span style="color:#f92672">=</span> list(filter(<span style="color:#66d9ef">lambda</span> x: x[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> projects_to_ignore, similar_projects))
        
        recommendations_df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(similar_projects_filtered, columns<span style="color:#f92672">=</span>[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">recStrength</span><span style="color:#e6db74">&#39;</span>])<span style="color:#f92672">.</span>head(topn)

        recommendations_df <span style="color:#f92672">=</span> recommendations_df<span style="color:#f92672">.</span>merge(self<span style="color:#f92672">.</span>projects_df, how <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">left</span><span style="color:#e6db74">&#39;</span>, 
                                                    left_on <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#39;</span>, 
                                                    right_on <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#39;</span>)[[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">recStrength</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project Title</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project Essay</span><span style="color:#e6db74">&#39;</span>]]


        <span style="color:#66d9ef">return</span> recommendations_df


cbr_model <span style="color:#f92672">=</span> ContentBasedRecommender(projects)


<span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">recommend for user </span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">+</span> str(mydonor1))
<span style="color:#66d9ef">print</span>(cbr_model<span style="color:#f92672">.</span>recommend_projects(mydonor1))

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">recommend for user </span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">+</span> str(mydonor2))
<span style="color:#66d9ef">print</span>(cbr_model<span style="color:#f92672">.</span>recommend_projects(mydonor2))
</code></pre></div><p>Kết quả</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">recommend <span style="color:#66d9ef">for</span> user <span style="color:#ae81ff">6</span>d5b22d39e68c656071a842732c63a0c
   recStrength                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                                                              Project Essay
<span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">1.000000</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          the music students <span style="color:#f92672">in</span> our classes perform freq<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">1</span>     <span style="color:#ae81ff">0.390997</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          i have spent <span style="color:#ae81ff">12</span> years <span style="color:#66d9ef">as</span> an educator rebuildin<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">2</span>     <span style="color:#ae81ff">0.338676</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">music is what feelings sound like.</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">-</span>g<span style="color:#f92672">.</span> cates<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">3</span>     <span style="color:#ae81ff">0.331034</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          true music <span style="color:#f92672">is</span> created <span style="color:#f92672">not</span> by the teacher but b<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">4</span>     <span style="color:#ae81ff">0.324355</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          every morning my first grade students come to <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">5</span>     <span style="color:#ae81ff">0.322923</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          <span style="color:#f92672">in</span> today<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">s fast paced environment, students ne...</span>
<span style="color:#ae81ff">6</span>     <span style="color:#ae81ff">0.315910</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">music is a moral law.  it gives soul to the u...</span>
<span style="color:#ae81ff">7</span>     <span style="color:#ae81ff">0.314845</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          i walk <span style="color:#f92672">in</span> the door so excited to get the stude<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">8</span>     <span style="color:#ae81ff">0.310103</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          some students have never put their hands on a <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">9</span>     <span style="color:#ae81ff">0.297516</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          my students do <span style="color:#f92672">not</span> have money, but they do hav<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>

[<span style="color:#ae81ff">10</span> rows x <span style="color:#ae81ff">4</span> columns]
recommend <span style="color:#66d9ef">for</span> user <span style="color:#ae81ff">0016</span>b23800f7ea46424b3254f016007a
   recStrength                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                                                              Project Essay
<span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">1.000000</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          my students are creative, curious, <span style="color:#f92672">and</span> excited<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">1</span>     <span style="color:#ae81ff">0.211962</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          our school <span style="color:#f92672">is</span> a title <span style="color:#ae81ff">1</span> school<span style="color:#f92672">.</span>  <span style="color:#ae81ff">100</span><span style="color:#f92672">%</span> of stude<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">2</span>     <span style="color:#ae81ff">0.189111</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          my students are active <span style="color:#f92672">and</span> eager learners who <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">3</span>     <span style="color:#ae81ff">0.188095</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          being a small rural school we do a lot of trad<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">4</span>     <span style="color:#ae81ff">0.173520</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">science is a way of life...science is the pro...</span>
<span style="color:#ae81ff">5</span>     <span style="color:#ae81ff">0.159015</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          my second grade students love to come to schoo<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">6</span>     <span style="color:#ae81ff">0.158071</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          i teach <span style="color:#ae81ff">28</span> fourth graders <span style="color:#f92672">in</span> a neighborhood sc<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">7</span>     <span style="color:#ae81ff">0.150389</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          <span style="color:#f92672">in</span> my classroom we are working hard to become <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">8</span>     <span style="color:#ae81ff">0.144724</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          <span style="color:#66d9ef">as</span> a teacher <span style="color:#f92672">in</span> a diverse, low<span style="color:#f92672">-</span>income, high<span style="color:#f92672">-</span>po<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">9</span>     <span style="color:#ae81ff">0.139937</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          have you ever been told you need to read, but <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>

[<span style="color:#ae81ff">10</span> rows x <span style="color:#ae81ff">4</span> columns]
</code></pre></div><p>Mình dùng cmd nên bị giới hạn kết quả, các bạn có thể write log vào file hoặc dùng jupiter để show kết quả rõ hơn.</p>
<p>Ở đây, chúng ta nhận thấy rằng các recommend cho donor 1 thường là những project liên quan tới âm nhạc (nhìn tập feature ta cũng có thể đoán được). Và recommend cho donor 2 là những thứ liên quan đến chủ đề làm vườn và reading.</p>
<h4 id="3-collaborative-filtering-model">3. Collaborative Filtering Model</h4>
<p>Lý thuyết về Collaborative Filtering Model các bạn có thể xem ở các bài viết khác của mình hoặc tham khảo thêm trên mạng. Ở đây, mình sẽ sử dụng Singular Value Decomposition (SVD) để xây dựng ma trận đặc trưng.</p>
<h5 id="a-xây-dựng-ma-trận-donor---project">a. Xây dựng ma trận donor - project</h5>
<p>Đầu tiên, chúng ta sẽ xây dựng ma trận mối quan hệ giữa donor và project. Nếu donor i có donated cho 1 project j thì dòng i cột j của ma trận sẽ được đánh dấu là 1, ngược lại là 0.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#### create matrix</span>
<span style="color:#75715e">#Creating a sparse pivot table with donors in rows and projects in columns</span>
donors_projects_pivot_matrix_df <span style="color:#f92672">=</span> donations_full_df<span style="color:#f92672">.</span>pivot(index<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Donor ID</span><span style="color:#e6db74">&#39;</span>, 
                                                          columns<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#39;</span>, 
                                                          values<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">eventStrength</span><span style="color:#e6db74">&#39;</span>)<span style="color:#f92672">.</span>fillna(<span style="color:#ae81ff">0</span>)

<span style="color:#75715e"># Transform the donor-project dataframe into a matrix</span>
donors_projects_pivot_matrix <span style="color:#f92672">=</span> donors_projects_pivot_matrix_df<span style="color:#f92672">.</span>as_matrix()

<span style="color:#75715e"># Get donor ids</span>
donors_ids <span style="color:#f92672">=</span> list(donors_projects_pivot_matrix_df<span style="color:#f92672">.</span>index)

<span style="color:#66d9ef">print</span>(donors_projects_pivot_matrix[:<span style="color:#ae81ff">5</span>]) <span style="color:#75715e"># print first 5 row</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
array([[ <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>, <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>,  <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>],
       [ <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>, <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>,  <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>],
       [ <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>, <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>,  <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>],
       [ <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>, <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>,  <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>],
       [ <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>, <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>,  <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>,  <span style="color:#ae81ff">0.</span>]])
</code></pre></div><h5 id="b-singular-value-decomposition">b. Singular Value Decomposition</h5>
<p>Sau khi có ma trận trên, ta có một nhận xét rằng nó rất thưa, số lượng 0 thì nhiều mà 1 thì ít. Sau khi áp dụng SVD, ma trận kết quả sẽ ít thưa hơn (có thể đạt được đến mức không còn thưa nữa).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Performs matrix factorization of the original donor-project matrix</span>
<span style="color:#75715e"># Here we set k = 20, which is the number of factors we are going to get</span>
<span style="color:#75715e"># In the definition of SVD, an original matrix A is approxmated as a product A ≈ UΣV </span>
<span style="color:#75715e"># where U and V have orthonormal columns, and Σ is non-negative diagonal.</span>
U, sigma, Vt <span style="color:#f92672">=</span> svds(donors_projects_pivot_matrix, k <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>)
sigma <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>diag(sigma)

<span style="color:#75715e"># Reconstruct the matrix by multiplying its factors</span>
all_donor_predicted_ratings <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>dot(np<span style="color:#f92672">.</span>dot(U, sigma), Vt) 

<span style="color:#75715e">#Converting the reconstructed matrix back to a Pandas dataframe</span>
cf_preds_df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(all_donor_predicted_ratings, 
                           columns <span style="color:#f92672">=</span> donors_projects_pivot_matrix_df<span style="color:#f92672">.</span>columns, 
                           index<span style="color:#f92672">=</span>donors_ids)<span style="color:#f92672">.</span>transpose()
						   
<span style="color:#66d9ef">print</span>(cf_preds_df<span style="color:#f92672">.</span>head())

</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">                                  <span style="color:#ae81ff">0003</span>aba06ccf49f8c44fc2dd3b582411                <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                 ffff088c35d3455779a30898d1327b76
Project ID                                                                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>

<span style="color:#ae81ff">00000</span><span style="color:#ae81ff">9891526</span>c0ade7180f8423792063                     <span style="color:#f92672">-</span><span style="color:#ae81ff">3.423182e-34</span>                <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">-</span><span style="color:#ae81ff">4.577244e-34</span>
<span style="color:#ae81ff">00000</span>ce845c00cbf0686c992fc369df4                     <span style="color:#f92672">-</span><span style="color:#ae81ff">3.061322e-36</span>                <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">-</span><span style="color:#ae81ff">6.492305e-36</span>
<span style="color:#ae81ff">00002</span>d44003ed46b066607c5455a999a                      <span style="color:#ae81ff">1.368936e-33</span>                <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">-</span><span style="color:#ae81ff">2.239156e-32</span>
<span style="color:#ae81ff">00002</span>eb25d60a09c318efbd0797bffb5                      <span style="color:#ae81ff">1.784576e-33</span>                <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1.163684e-32</span>
<span style="color:#ae81ff">0000300773</span>fe015f870914b42528541b                      <span style="color:#ae81ff">4.314216e-34</span>                <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">-</span><span style="color:#ae81ff">4.666110e-34</span>

[<span style="color:#ae81ff">5</span> rows x <span style="color:#ae81ff">8015</span> columns]
</code></pre></div><h5 id="c-xây-dựng-collaborative-filtering-model">c. Xây dựng Collaborative Filtering Model</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CFRecommender</span>:
    
    MODEL_NAME <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Collaborative Filtering</span><span style="color:#e6db74">&#39;</span>
    
    <span style="color:#66d9ef">def</span> __init__(self, cf_predictions_df, projects_df<span style="color:#f92672">=</span>None):
        self<span style="color:#f92672">.</span>cf_predictions_df <span style="color:#f92672">=</span> cf_predictions_df
        self<span style="color:#f92672">.</span>projects_df <span style="color:#f92672">=</span> projects_df
        
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_model_name</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>MODEL_NAME
        
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">recommend_projects</span>(self, donor_id, projects_to_ignore<span style="color:#f92672">=</span>[], topn<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>):
        <span style="color:#75715e"># Get and sort the donor&#39;s predictions</span>
        sorted_donor_predictions <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>cf_predictions_df[donor_id]<span style="color:#f92672">.</span>sort_values(ascending<span style="color:#f92672">=</span>False) \
                                    <span style="color:#f92672">.</span>reset_index()<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{donor_id: <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">recStrength</span><span style="color:#e6db74">&#39;</span>})

        <span style="color:#75715e"># Recommend the highest predicted projects that the donor hasn&#39;t donated to</span>
        recommendations_df <span style="color:#f92672">=</span> sorted_donor_predictions[<span style="color:#f92672">~</span>sorted_donor_predictions[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>isin(projects_to_ignore)] \
                               <span style="color:#f92672">.</span>sort_values(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">recStrength</span><span style="color:#e6db74">&#39;</span>, ascending <span style="color:#f92672">=</span> False) \
                               <span style="color:#f92672">.</span>head(topn)

 
        recommendations_df <span style="color:#f92672">=</span> recommendations_df<span style="color:#f92672">.</span>merge(self<span style="color:#f92672">.</span>projects_df, how <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">left</span><span style="color:#e6db74">&#39;</span>, 
                                                          left_on <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#39;</span>, 
                                                          right_on <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#39;</span>)[[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">recStrength</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project Title</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project Essay</span><span style="color:#e6db74">&#39;</span>]]


        <span style="color:#66d9ef">return</span> recommendations_df

cfr_model <span style="color:#f92672">=</span> CFRecommender(cf_preds_df, projects)
<span style="color:#66d9ef">print</span>(cfr_model<span style="color:#f92672">.</span>recommend_projects(mydonor1))

<span style="color:#66d9ef">print</span>(cfr_model<span style="color:#f92672">.</span>recommend_projects(mydonor2))

</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">[<span style="color:#ae81ff">5</span> rows x <span style="color:#ae81ff">8015</span> columns]
    recStrength                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                                                              Project Essay
<span style="color:#ae81ff">0</span>  <span style="color:#ae81ff">3.015461e-17</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          Our students are some of the hardest working k<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">2.237275e-17</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          As Service Learning Coordinators at our elemen<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">2.188501e-17</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          We are trying to engage more students <span style="color:#f92672">in</span> scien<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">1.768711e-17</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          We are a brand new charter school that has onl<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">1.344489e-17</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          Sitting at a desk <span style="color:#66d9ef">for</span> a sustained period of ti<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">9.957278e-18</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          Our students come <span style="color:#f92672">from</span> a Title I school in Jer...
<span style="color:#ae81ff">6</span>  <span style="color:#ae81ff">6.932330e-18</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          In my school <span style="color:#ae81ff">50</span><span style="color:#f92672">%</span> of the students are socioecon<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">7</span>  <span style="color:#ae81ff">8.589640e-19</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          Have you ever been told you need to read, but <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">8</span>  <span style="color:#ae81ff">6.698040e-19</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">I cannot say good-bye to those whom I have gr...</span>
<span style="color:#ae81ff">9</span>  <span style="color:#ae81ff">5.733941e-19</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          I have students <span style="color:#f92672">in</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">who</span> are squinting <span style="color:#f92672">and</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>

[<span style="color:#ae81ff">10</span> rows x <span style="color:#ae81ff">4</span> columns]
    recStrength                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                                                              Project Essay
<span style="color:#ae81ff">0</span>  <span style="color:#ae81ff">3.015461e-17</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          Our students are some of the hardest working k<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">2.237275e-17</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          As Service Learning Coordinators at our elemen<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">2.188501e-17</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          We are trying to engage more students <span style="color:#f92672">in</span> scien<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">1.768711e-17</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          We are a brand new charter school that has onl<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">1.344489e-17</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          Sitting at a desk <span style="color:#66d9ef">for</span> a sustained period of ti<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">9.957278e-18</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          Our students come <span style="color:#f92672">from</span> a Title I school in Jer...
<span style="color:#ae81ff">6</span>  <span style="color:#ae81ff">6.932330e-18</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          In my school <span style="color:#ae81ff">50</span><span style="color:#f92672">%</span> of the students are socioecon<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">7</span>  <span style="color:#ae81ff">8.589640e-19</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          Have you ever been told you need to read, but <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">8</span>  <span style="color:#ae81ff">6.698040e-19</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">I cannot say good-bye to those whom I have gr...</span>
<span style="color:#ae81ff">9</span>  <span style="color:#ae81ff">5.733941e-19</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          I have students <span style="color:#f92672">in</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">who</span> are squinting <span style="color:#f92672">and</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
</code></pre></div><p>Kết quả trả về có vẻ không được đẹp như ở phương pháp trên. Ở đây, thuật toán dựa vào hành vi donated của những người khác có điểm tương đồng với user donor 1 và 2. Bởi vậy gợi ý những project sẽ khác những gợi ý ở phương pháp 1.</p>
<h4 id="4-hybrid-method">4. Hybrid Method</h4>
<p>Phương pháp lai này kết hợp cả 2 hướng tiếp cận của hai phương pháp ở trên. Ở đây, chúng ta sẽ xây dựng một mô hình nhỏ, nhân điểm của content based và collaborative filtering lại với nhau, sau đó xếp hạng để được điểm hybrid. Đây là 1 cách đơn giản, các bạn có thể tìm đọc nhiều cách tiếp cận khác và ứng dụng vào bài toán.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">HybridRecommender</span>:
    
    MODEL_NAME <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Hybrid</span><span style="color:#e6db74">&#39;</span>
    
    <span style="color:#66d9ef">def</span> __init__(self, cb_rec_model, cf_rec_model, projects_df):
        self<span style="color:#f92672">.</span>cb_rec_model <span style="color:#f92672">=</span> cb_rec_model
        self<span style="color:#f92672">.</span>cf_rec_model <span style="color:#f92672">=</span> cf_rec_model
        self<span style="color:#f92672">.</span>projects_df <span style="color:#f92672">=</span> projects_df
        
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_model_name</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>MODEL_NAME
        
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">recommend_projects</span>(self, donor_id, projects_to_ignore<span style="color:#f92672">=</span>[], topn<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>):
        <span style="color:#75715e">#Getting the top-1000 Content-based filtering recommendations</span>
        cb_recs_df <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>cb_rec_model<span style="color:#f92672">.</span>recommend_projects(donor_id, projects_to_ignore<span style="color:#f92672">=</span>projects_to_ignore, 
                                                           topn<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>)<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">recStrength</span><span style="color:#e6db74">&#39;</span>: <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">recStrengthCB</span><span style="color:#e6db74">&#39;</span>})
        
        <span style="color:#75715e">#Getting the top-1000 Collaborative filtering recommendations</span>
        cf_recs_df <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>cf_rec_model<span style="color:#f92672">.</span>recommend_projects(donor_id, projects_to_ignore<span style="color:#f92672">=</span>projects_to_ignore,  
                                                           topn<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>)<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">recStrength</span><span style="color:#e6db74">&#39;</span>: <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">recStrengthCF</span><span style="color:#e6db74">&#39;</span>})
        
        <span style="color:#75715e">#Combining the results by Project ID</span>
        recs_df <span style="color:#f92672">=</span> cb_recs_df<span style="color:#f92672">.</span>merge(cf_recs_df,
                                   how <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">inner</span><span style="color:#e6db74">&#39;</span>, 
                                   left_on <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#39;</span>, 
                                   right_on <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#39;</span>)
        
        <span style="color:#75715e">#Computing a hybrid recommendation score based on CF and CB scores</span>
        recs_df[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">recStrengthHybrid</span><span style="color:#e6db74">&#39;</span>] <span style="color:#f92672">=</span> recs_df[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">recStrengthCB</span><span style="color:#e6db74">&#39;</span>] <span style="color:#f92672">*</span> recs_df[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">recStrengthCF</span><span style="color:#e6db74">&#39;</span>]
        
        <span style="color:#75715e">#Sorting recommendations by hybrid score</span>
        recommendations_df <span style="color:#f92672">=</span> recs_df<span style="color:#f92672">.</span>sort_values(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">recStrengthHybrid</span><span style="color:#e6db74">&#39;</span>, ascending<span style="color:#f92672">=</span>False)<span style="color:#f92672">.</span>head(topn)

        recommendations_df <span style="color:#f92672">=</span> recommendations_df<span style="color:#f92672">.</span>merge(self<span style="color:#f92672">.</span>projects_df, how <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">left</span><span style="color:#e6db74">&#39;</span>, 
                                                    left_on <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#39;</span>, 
                                                    right_on <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#39;</span>)[[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">recStrengthHybrid</span><span style="color:#e6db74">&#39;</span>, 
                                                                              <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project ID</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project Title</span><span style="color:#e6db74">&#39;</span>, 
                                                                              <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Project Essay</span><span style="color:#e6db74">&#39;</span>]]


        <span style="color:#66d9ef">return</span> recommendations_df
    
hybrid_model <span style="color:#f92672">=</span> HybridRecommender(cbr_model, cfr_model, projects)


<span style="color:#66d9ef">print</span>(hybrid_model<span style="color:#f92672">.</span>recommend_projects(mydonor1))

<span style="color:#66d9ef">print</span>(hybrid_model<span style="color:#f92672">.</span>recommend_projects(mydonor2))

</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">   recStrengthHybrid                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                                                              Project Essay
<span style="color:#ae81ff">0</span>       <span style="color:#ae81ff">1.574375e-18</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          we are trying to engage more students <span style="color:#f92672">in</span> scien<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">1</span>       <span style="color:#ae81ff">1.221807e-18</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          <span style="color:#f92672">in</span> my school <span style="color:#ae81ff">50</span><span style="color:#f92672">%</span> of the students are socioecon<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">2</span>       <span style="color:#ae81ff">1.214293e-18</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          our students are some of the hardest working k<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">3</span>       <span style="color:#ae81ff">4.037232e-19</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          sitting at a desk <span style="color:#66d9ef">for</span> a sustained period of ti<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">4</span>       <span style="color:#ae81ff">6.661794e-20</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          <span style="color:#960050;background-color:#1e0010">“</span>music expresses that which cannot be put into<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">5</span>       <span style="color:#ae81ff">4.872264e-20</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          i walk <span style="color:#f92672">in</span> the door so excited to get the stude<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">6</span>       <span style="color:#ae81ff">4.410098e-20</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          i have spent <span style="color:#ae81ff">12</span> years <span style="color:#66d9ef">as</span> an educator rebuildin<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">7</span>       <span style="color:#ae81ff">2.907349e-20</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">music is what feelings sound like.</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">-</span>g<span style="color:#f92672">.</span> cates<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">8</span>       <span style="color:#ae81ff">2.121616e-20</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">i cannot say good-bye to those whom i have gr...</span>
<span style="color:#ae81ff">9</span>       <span style="color:#ae81ff">1.353927e-20</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          our band program <span style="color:#f92672">is</span> one of the largest <span style="color:#f92672">in</span> our <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>

[<span style="color:#ae81ff">10</span> rows x <span style="color:#ae81ff">4</span> columns]
   recStrengthHybrid                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                                                              Project Essay
<span style="color:#ae81ff">0</span>       <span style="color:#ae81ff">2.811124e-18</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          <span style="color:#f92672">in</span> this modern, digital age, i would like to u<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">1</span>       <span style="color:#ae81ff">1.249967e-18</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          we are a brand new charter school that has onl<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">2</span>       <span style="color:#ae81ff">6.055628e-19</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          my students are african american <span style="color:#f92672">and</span> hispanic<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">3</span>       <span style="color:#ae81ff">5.912367e-19</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          the a<span style="color:#f92672">.</span> community <span style="color:#f92672">and</span> its students are a very s<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">4</span>       <span style="color:#ae81ff">2.541749e-19</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          do you want to go on an adventure <span style="color:#f92672">and</span> learn ab<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">5</span>       <span style="color:#ae81ff">2.494812e-19</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          the average day <span style="color:#f92672">in</span> my <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">involves</span> students <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">6</span>       <span style="color:#ae81ff">2.323313e-19</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          i teach ela (reading component) to self<span style="color:#f92672">-</span>contai<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">7</span>       <span style="color:#ae81ff">1.271629e-19</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          hi there<span style="color:#960050;background-color:#1e0010">!</span> do you want to help to instill a lif<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">8</span>       <span style="color:#ae81ff">1.044990e-19</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          having writing utensils <span style="color:#f92672">is</span> essential <span style="color:#66d9ef">for</span> stude<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#ae81ff">9</span>       <span style="color:#ae81ff">1.004780e-19</span>                        <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>                          there<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">s no such thing as a kid who hates readi...</span>

[<span style="color:#ae81ff">10</span> rows x <span style="color:#ae81ff">4</span> columns]
</code></pre></div><p>Kết quả trả ra tốt hơn nhiều so với cách 2, donor1 có music, donor2 có cây trồng và sách.</p>
<h4 id="5-đánh-giá-mô-hình">5. Đánh giá mô hình</h4>
<p>Có rất nhiều cách khác nhau để đánh giá mô hình recommend system. Một trong các cách mình sử dụng ở đây là sử dụng độ đo top K accuracy. Độ đo này được tính như sau:</p>
<p>Với mỗi user:
Với mỗi item user đã pick trong test set
Lấy mẫu 1000 item khác mà người dùng chưa bao giờ pick</p>
<p>Cảm ơn các bạn đã theo dõi. Hẹn gặp bạn ở các bài viết tiếp theo. Cố lên.</p>

  </div>
  
			</div>
  <footer class="col-md-10  mx-auto">
  <div >
  <div class="fb-like" data-share="true"  data-width="450"  data-show-faces="true">
</div> </p></div>
    <ul class="stats list-unstyled">
 
    
  <li class="tags">
    <ul class="list-inline">
       
            
            
                <i class="fa fa-tags"></i>
                
                
                <li class="list-inline-item"><a class="article-category-link" href="/tags/machine-learning">Machine learning</a></li>
                
                
                <li class="list-inline-item"><a class="article-category-link" href="/tags/deeplearning">Deeplearning</a></li>
                
                
                <li class="list-inline-item"><a class="article-category-link" href="/tags/recommender-system">recommender system</a></li>
                
            
        
    </ul>
  </li>
  
</ul>

	</div>
  </footer>
  <hr/>
<div class="titlerelate">Bài viết khác</div>
<div class="infinite-container featured-task">
<div class="card-deck card-break infinite-item">



    
        <div class="card">
		<a href="/blog/2018-12-11-a-bunch-of-tips-and-tricks-for-training-deep-neural-networks/"
                class="button big previous">
		
		<img class="card-img-top lazy" src="/post_image/Object-Detection-for-outdoor-cv-tricks.jpg" width="100" />
		<div class="card-body">
		<h5 class="card-title">
		Một số mẹo để lựa chọn mô hình object detection
				</h5>
				</div>
				</a>
				</div>
    

    
        <div class="card">
		<a href="/blog/2019-02-05-5-python-tricks-you-need-to-know-today/"
                class="button big previous">
		
		<img class="card-img-top lazy" src="/post_image/python_range.png" width="100" />
		
		<div class="card-body">
		<h5 class="card-title">
		5 mẹo hay sử dụng python
				</h5>
				</div>
				</a>
				</div>
    

</div>
</div>



<div class="fb-comments" data-href="" data-width="" data-numposts="5"></div>

    <article class="post">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "phamduytung" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </article>



</article>


		
    </main>
    
	</div>
	</div>
    
	<hr>
  <footer class="footer">
  <div class="container text-center">
    
    <p class="copyright">
      
        &copy; 2020
        
          Phạm Duy Tùng Machine Learning Blog
        
      
     
    </p>
	</div>
  </footer>
    
    

    
      
    

    
      
      
      
        <script src="//cdn.bootcss.com/highlight.js/9.15.8/highlight.min.js"></script>
        
        
        
        <script src="//cdn.bootcss.com/highlight.js/9.15.8/languages/python.min.js"></script>
        <script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>
      
    
    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/skel/3.0.1/skel.min.js"></script>
     

   <script src="/js/jquery-3.3.1.min.js"></script>
   
    <script src="/js/bootstrap.min.js"></script>
      <script src="/js/util.js"></script>
      <script src="/js/main.js"></script>
     
    

    
      
        
      
    
	
    
    <script>hljs.initHighlightingOnLoad();</script>
      
<script async
src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


	  
	  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-114911596-1"  data-cfasync="false"></script>
<script  data-cfasync="false">
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-114911596-1');
</script>
<script src="https://cdn.jsdelivr.net/npm/intersection-observer@0.5.1/intersection-observer.js"  data-cfasync="false"></script>
<script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@12.0.0/dist/lazyload.min.js"  data-cfasync="false"></script>
	   <script  type="text/javascript"  data-cfasync="false">

  function getcontent(){
 

   

             var myLazyLoad = new LazyLoad({
    elements_selector: ".lazy"
});
                }
            
			
			$(document).ready(function(){
			getcontent();
			}); 
</script>

  </body>
</html>

